Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='/content/3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR2_CORRUPTION', eval_step=1, save_step=10, ckpt_path='/content/SemNov_AML_DAAI_23-24/trained_models/DGCNN_CE_SR2_CORRUPTION.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', wandb_api=None, loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, open_shape=None, corruption='all', tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
get_list_corr_data for modelnet_set2 - split train
loading both lidar and occlusion data
corr list files: ['/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev4.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev4.h5']

Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev1.h5 datas: (1916, 768, 3), labels: (1916,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev2.h5 datas: (1915, 768, 3), labels: (1915,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev3.h5 datas: (1915, 768, 3), labels: (1915,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_train_lidar_sev4.h5 datas: (1916, 768, 3), labels: (1916,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev1.h5 datas: (1916, 1024, 3), labels: (1916,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev2.h5 datas: (1916, 1024, 3), labels: (1916,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev3.h5 datas: (1915, 1024, 3), labels: (1915,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_train_occlusion_sev4.h5 datas: (1916, 1024, 3), labels: (1916,)
Cumulative (clean+corrupted) train data len: 17241
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 400, 1: 401, 2: 402, 3: 403, 11: 404}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 4, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8001 M
Load weights:  <All keys matched successfully>



Src logits: torch.Size([788, 4]), tar1 logits: torch.Size([1255, 4]), tar2 logits: torch.Size([847, 4])

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
OOD F1 Test - Acc: 0.4014, Th: 0.5057
OOD J Test - Acc: 0.6672, Th: 0.9992
Test Tar2
OOD F1 Test - Acc: 0.4991, Th: 0.5057
OOD J Test - Acc: 0.6379, Th: 0.9890
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6156, Th: 0.9832
Fail src: 340/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 164	| table    	| 0.8256	| 0.4709	| 0.9826
 table    	| OOD	| 75	| desk    	| 0.7904	| 0.3452	| 0.9820
 display    	| OOD	| 19	| display    	| 0.8382	| 0.5663	| 0.9810
 bed    	| OOD	| 18	| bed    	| 0.8954	| 0.6928	| 0.9714
 table    	| OOD	| 17	| display    	| 0.6684	| 0.4768	| 0.9665
Fail tar: 771/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 143	| desk    	| 0.9971	| 0.9839	| 1.0000
 shelf    	| ID	| 109	| bed    	| 0.9952	| 0.9835	| 1.0000
 cabinet    	| ID	| 82	| bed    	| 0.9967	| 0.9838	| 1.0000
 chair    	| ID	| 68	| display    	| 0.9953	| 0.9836	| 1.0000
 sofa    	| ID	| 50	| desk    	| 0.9969	| 0.9843	| 1.0000
OOD J Test - Acc: 0.7343, Th: 0.9992
Fail src: 511/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 235	| table    	| 0.8759	| 0.4709	| 0.9990
 table    	| OOD	| 94	| desk    	| 0.8314	| 0.3452	| 0.9991
 desk    	| OOD	| 46	| desk    	| 0.9332	| 0.4883	| 0.9992
 display    	| OOD	| 43	| display    	| 0.9254	| 0.5663	| 0.9989
 bed    	| OOD	| 31	| bed    	| 0.9371	| 0.6928	| 0.9985
Fail tar: 257/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 65	| desk    	| 0.9998	| 0.9992	| 1.0000
 cabinet    	| ID	| 39	| bed    	| 0.9998	| 0.9992	| 1.0000
 sofa    	| ID	| 25	| desk    	| 0.9998	| 0.9992	| 1.0000
 sink    	| ID	| 24	| desk    	| 0.9997	| 0.9993	| 1.0000
 shelf    	| ID	| 24	| bed    	| 0.9996	| 0.9992	| 1.0000
SRC->TAR1:      AUROC: 0.6161, FPR95: 0.9243, AUPR_IN: 0.5586, AUPR_OUT: 0.6832, F1_TH: 0.5057, F1_TH_ACC: 0.4014, J_TH: 0.9992, J_TH_ACC: 0.6672
SRC->TAR2:      AUROC: 0.6680, FPR95: 0.8985, AUPR_IN: 0.6774, AUPR_OUT: 0.6453, F1_TH: 0.5057, F1_TH_ACC: 0.4991, J_TH: 0.9890, J_TH_ACC: 0.6379
SRC->TAR1+TAR2: AUROC: 0.6370, FPR95: 0.9139, AUPR_IN: 0.4584, AUPR_OUT: 0.7976, F1_TH: 0.9832, F1_TH_ACC: 0.6156, J_TH: 0.9992, J_TH_ACC: 0.7343
to spreadsheet: 0.6160823710235201,0.9243027888446215,0.5586236668768412,0.6831965732915497,0.6680273464422057,0.898465171192444,0.677357130149937,0.6453209600595351,0.6370135766275291,0.9138915318744053,0.45843281613431486,0.7976331225849695
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
OOD F1 Test - Acc: 0.3916, Th: 1.3676
OOD J Test - Acc: 0.6353, Th: 6.5950
Test Tar2
OOD F1 Test - Acc: 0.5235, Th: 1.9421
OOD J Test - Acc: 0.6220, Th: 5.4580
Test Tar1+Tar2
OOD F1 Test - Acc: 0.4747, Th: 3.8477
Fail src: 190/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 98	| table    	| 2.7701	| 0.9084	| 3.8356
 table    	| OOD	| 41	| desk    	| 2.6191	| 0.5044	| 3.7322
 table    	| OOD	| 14	| display    	| 2.0542	| 1.0513	| 3.3599
 table    	| OOD	| 11	| bed    	| 2.4575	| 1.4056	| 3.7328
 display    	| OOD	| 9	| display    	| 3.1979	| 2.5714	| 3.8156
Fail tar: 1328/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 186	| bed    	| 6.6800	| 3.8893	| 11.6893
 toilet    	| ID	| 170	| desk    	| 7.0301	| 3.8746	| 15.1005
 cabinet    	| ID	| 145	| bed    	| 8.3053	| 3.8772	| 16.3625
 chair    	| ID	| 114	| display    	| 5.7507	| 3.8888	| 13.3483
 chair    	| ID	| 92	| desk    	| 5.7330	| 3.8616	| 11.1502
OOD J Test - Acc: 0.6799, Th: 6.5950
Fail src: 442/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 214	| table    	| 3.9898	| 0.9084	| 6.5505
 table    	| OOD	| 88	| desk    	| 4.0518	| 0.5044	| 6.5806
 display    	| OOD	| 39	| display    	| 4.7385	| 2.5714	| 6.3804
 desk    	| OOD	| 25	| desk    	| 5.2326	| 1.5532	| 6.5675
 table    	| OOD	| 18	| display    	| 2.6446	| 1.0513	| 5.7495
Fail tar: 483/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 92	| bed    	| 10.0557	| 6.6905	| 16.3625
 toilet    	| ID	| 89	| desk    	| 8.5556	| 6.6126	| 15.1005
 shelf    	| ID	| 85	| bed    	| 8.1294	| 6.6066	| 11.6893
 sofa    	| ID	| 38	| desk    	| 9.0243	| 6.7705	| 13.9906
 sink    	| ID	| 29	| desk    	| 8.8683	| 6.6293	| 13.7495
SRC->TAR1:      AUROC: 0.6082, FPR95: 0.9363, AUPR_IN: 0.5585, AUPR_OUT: 0.6697, F1_TH: 1.3676, F1_TH_ACC: 0.3916, J_TH: 6.5950, J_TH_ACC: 0.6353
SRC->TAR2:      AUROC: 0.6539, FPR95: 0.8701, AUPR_IN: 0.6253, AUPR_OUT: 0.6501, F1_TH: 1.9421, F1_TH_ACC: 0.5235, J_TH: 5.4580, J_TH_ACC: 0.6220
SRC->TAR1+TAR2: AUROC: 0.6266, FPR95: 0.9096, AUPR_IN: 0.4240, AUPR_OUT: 0.7935, F1_TH: 3.8477, F1_TH_ACC: 0.4747, J_TH: 6.5950, J_TH_ACC: 0.6799
to spreadsheet: 0.6081855319837401,0.9362549800796812,0.5584715728647084,0.6696722206846993,0.6538559502334307,0.8701298701298701,0.6252558834597526,0.650063184385049,0.6265884074630398,0.9096098953377736,0.4239799832652656,0.7934642656172719
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
OOD F1 Test - Acc: 0.3965, Th: 3.8546
OOD J Test - Acc: 0.6662, Th: 549.1671
Test Tar2
OOD F1 Test - Acc: 0.5003, Th: 3.8546
OOD J Test - Acc: 0.6410, Th: 65.4207
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6114, Th: 40.7814
Fail src: 335/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 160	| table    	| 12.2990	| 3.4003	| 37.7091
 table    	| OOD	| 74	| desk    	| 11.3050	| 3.1719	| 39.6466
 display    	| OOD	| 19	| display    	| 14.2005	| 5.2062	| 37.3839
 bed    	| OOD	| 18	| bed    	| 15.5866	| 5.3750	| 26.2443
 table    	| OOD	| 17	| display    	| 7.0605	| 3.5085	| 26.5405
Fail tar: 788/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 144	| desk    	| 55516.4291	| 41.7727	| 5452103.0000
 shelf    	| ID	| 113	| bed    	| 1372.9944	| 41.1296	| 69563.8594
 cabinet    	| ID	| 83	| bed    	| 23422.2152	| 42.5994	| 901060.0000
 chair    	| ID	| 69	| display    	| 10741.8987	| 41.1283	| 673245.1250
 sofa    	| ID	| 51	| desk    	| 25566.4303	| 42.8150	| 971125.6875
OOD J Test - Acc: 0.7208, Th: 340.6000
Fail src: 486/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 228	| table    	| 37.8111	| 3.4003	| 330.0143
 table    	| OOD	| 91	| desk    	| 28.4714	| 3.1719	| 288.8193
 display    	| OOD	| 39	| display    	| 72.3488	| 5.2062	| 298.9688
 desk    	| OOD	| 37	| desk    	| 90.3338	| 4.5472	| 311.8391
 bed    	| OOD	| 29	| bed    	| 62.2678	| 5.3750	| 285.4975
Fail tar: 321/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 83	| desk    	| 96209.0952	| 352.1615	| 5452103.0000
 cabinet    	| ID	| 46	| bed    	| 42158.0530	| 362.5675	| 901060.0000
 shelf    	| ID	| 33	| bed    	| 4368.5827	| 358.6268	| 69563.8594
 sink    	| ID	| 28	| desk    	| 46668.2296	| 373.7782	| 909072.6875
 sofa    	| ID	| 27	| desk    	| 48178.0085	| 396.2519	| 971125.6875
SRC->TAR1:      AUROC: 0.6157, FPR95: 0.9283, AUPR_IN: 0.5592, AUPR_OUT: 0.6805, F1_TH: 3.8546, F1_TH_ACC: 0.3965, J_TH: 549.1671, J_TH_ACC: 0.6662
SRC->TAR2:      AUROC: 0.6697, FPR95: 0.8902, AUPR_IN: 0.6787, AUPR_OUT: 0.6500, F1_TH: 3.8546, F1_TH_ACC: 0.5003, J_TH: 65.4207, J_TH_ACC: 0.6410
SRC->TAR1+TAR2: AUROC: 0.6375, FPR95: 0.9129, AUPR_IN: 0.4596, AUPR_OUT: 0.7978, F1_TH: 40.7814, F1_TH_ACC: 0.6114, J_TH: 340.6000, J_TH_ACC: 0.7208
to spreadsheet: 0.6157228952211458,0.9282868525896414,0.559179667357469,0.6805471352887233,0.6697226400733554,0.8902007083825265,0.6787371241855813,0.6499728726622315,0.6374820692886157,0.9129400570884871,0.4595901947058254,0.7978363275483824
################################################################################

################################################################################
Computing OOD metrics with distance from train features...




Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7843, Clf Bal Acc: 0.8386
Src Test - Fail: 170/788
	A table is predicted as desk - 84 times
	A table is predicted as display - 32 times
	A table is predicted as bed - 21 times
	A desk is predicted as table - 17 times
	A display is predicted as desk - 9 times
Test Tar1
OOD F1 Test - Acc: 0.6295, Th: 0.9261
OOD J Test - Acc: 0.6848, Th: 1.0942
Test Tar2
OOD F1 Test - Acc: 0.7260, Th: 0.9013
OOD J Test - Acc: 0.7443, Th: 0.9630
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7028, Th: 1.0208
Fail src: 245/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 92	| table    	| 0.8725	| 0.5697	| 1.0126
 table    	| OOD	| 41	| desk    	| 0.8739	| 0.6525	| 1.0076
 bed    	| OOD	| 29	| bed    	| 0.8519	| 0.6520	| 1.0109
 table    	| OOD	| 18	| display    	| 0.8398	| 0.6689	| 0.9775
 table    	| OOD	| 18	| bed    	| 0.8320	| 0.5155	| 1.0119
Fail tar: 614/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 163	| desk    	| 1.3412	| 1.0257	| 2.2760
 chair    	| ID	| 85	| display    	| 1.2797	| 1.0314	| 1.9803
 chair    	| ID	| 45	| desk    	| 1.2552	| 1.0304	| 1.8329
 sink    	| ID	| 36	| desk    	| 1.2673	| 1.0236	| 1.7818
 door    	| ID	| 32	| bed    	| 1.2432	| 1.0298	| 1.9943
OOD J Test - Acc: 0.6775, Th: 0.9761
Fail src: 199/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 72	| table    	| 0.8393	| 0.5697	| 0.9656
 table    	| OOD	| 37	| desk    	| 0.8605	| 0.6525	| 0.9718
 bed    	| OOD	| 21	| bed    	| 0.7974	| 0.6520	| 0.9261
 table    	| OOD	| 17	| display    	| 0.8317	| 0.6689	| 0.9548
 desk    	| OOD	| 15	| desk    	| 0.8723	| 0.7469	| 0.9630
Fail tar: 733/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 168	| desk    	| 1.3311	| 0.9842	| 2.2760
 chair    	| ID	| 101	| display    	| 1.2353	| 0.9843	| 1.9803
 chair    	| ID	| 52	| desk    	| 1.2202	| 0.9773	| 1.8329
 cabinet    	| ID	| 42	| bed    	| 1.0863	| 0.9790	| 1.3864
 sink    	| ID	| 39	| desk    	| 1.2465	| 0.9837	| 1.7818
SRC->TAR1:      AUROC: 0.7342, FPR95: 0.7275, AUPR_IN: 0.6061, AUPR_OUT: 0.8234, F1_TH: 0.9261, F1_TH_ACC: 0.6295, J_TH: 1.0942, J_TH_ACC: 0.6848
SRC->TAR2:      AUROC: 0.8229, FPR95: 0.6222, AUPR_IN: 0.8069, AUPR_OUT: 0.8320, F1_TH: 0.9013, F1_TH_ACC: 0.7260, J_TH: 0.9630, J_TH_ACC: 0.7443
SRC->TAR1+TAR2: AUROC: 0.7700, FPR95: 0.6851, AUPR_IN: 0.5383, AUPR_OUT: 0.8986, F1_TH: 1.0208, F1_TH_ACC: 0.7028, J_TH: 0.9761, J_TH_ACC: 0.6775
to spreadsheet: 0.7342498028191802,0.7274900398406374,0.60610330466388,0.8233600573617514,0.8229358320498146,0.6221959858323495,0.8069069235899631,0.8320139043466797,0.76998580032553,0.6850618458610847,0.5383274214520776,0.8986498973365494

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713, Clf Bal Acc: 0.2500
Src Test - Fail: 653/788
	A table is predicted as desk - 390 times
	A bed is predicted as desk - 181 times
	A display is predicted as desk - 82 times
Test Tar1
OOD F1 Test - Acc: 0.4630, Th: 0.2841
OOD J Test - Acc: 0.6500, Th: 0.4380
Test Tar2
OOD F1 Test - Acc: 0.5431, Th: 0.2841
OOD J Test - Acc: 0.6336, Th: 0.4351
Test Tar1+Tar2
OOD F1 Test - Acc: 0.3713, Th: 0.2841
Fail src: 27/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 23	| desk    	| 0.2727	| 0.2221	| 0.2833
 bed    	| OOD	| 3	| desk    	| 0.2646	| 0.2563	| 0.2803
 display    	| OOD	| 1	| desk    	| 0.2768	| 0.2768	| 0.2768
Fail tar: 1790/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 366	| desk    	| 0.3673	| 0.2843	| 0.7103
 cabinet    	| ID	| 283	| desk    	| 0.3534	| 0.2848	| 0.6239
 toilet    	| ID	| 254	| desk    	| 0.4553	| 0.2935	| 1.3101
 door    	| ID	| 221	| desk    	| 0.3491	| 0.2844	| 0.6004
 bin    	| ID	| 150	| desk    	| 0.3474	| 0.2841	| 0.6174
OOD J Test - Acc: 0.7180, Th: 0.4380
Fail src: 500/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 358	| desk    	| 0.3272	| 0.2221	| 0.4358
 display    	| OOD	| 51	| desk    	| 0.3631	| 0.2768	| 0.4271
 bed    	| OOD	| 48	| desk    	| 0.3610	| 0.2563	| 0.4369
 desk    	| OOD	| 43	| desk    	| 0.3725	| 0.3063	| 0.4359
Fail tar: 315/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 109	| desk    	| 0.5776	| 0.4382	| 1.3101
 chair    	| ID	| 53	| desk    	| 0.5163	| 0.4420	| 0.7103
 sink    	| ID	| 40	| desk    	| 0.5323	| 0.4381	| 0.8956
 sofa    	| ID	| 27	| desk    	| 0.5676	| 0.4517	| 0.8322
 cabinet    	| ID	| 26	| desk    	| 0.4956	| 0.4441	| 0.6239
SRC->TAR1:      AUROC: 0.6308, FPR95: 0.8422, AUPR_IN: 0.5441, AUPR_OUT: 0.7312, F1_TH: 0.2841, F1_TH_ACC: 0.4630, J_TH: 0.4380, J_TH_ACC: 0.6500
SRC->TAR2:      AUROC: 0.6577, FPR95: 0.8430, AUPR_IN: 0.6850, AUPR_OUT: 0.6641, F1_TH: 0.2841, F1_TH_ACC: 0.5431, J_TH: 0.4351, J_TH_ACC: 0.6336
SRC->TAR1+TAR2: AUROC: 0.6416, FPR95: 0.8425, AUPR_IN: 0.4528, AUPR_OUT: 0.8206, F1_TH: 0.2841, F1_TH_ACC: 0.3713, J_TH: 0.4380, J_TH_ACC: 0.7180
to spreadsheet: 0.630814811818715,0.8422310756972111,0.5441278686646902,0.7312238638248276,0.6576795378133633,0.8429752066115702,0.6849936346142704,0.6640569288217845,0.6416399416557593,0.8425309229305423,0.4527951512924331,0.8206204612917107

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7716, Clf Bal Acc: 0.8298
Src Test - Fail: 180/788
	A table is predicted as desk - 101 times
	A table is predicted as bed - 23 times
	A table is predicted as display - 22 times
	A desk is predicted as table - 17 times
	A display is predicted as desk - 10 times
Test Tar1
OOD F1 Test - Acc: 0.5428, Th: 0.9525
OOD J Test - Acc: 0.6716, Th: 0.9787
Test Tar2
OOD F1 Test - Acc: 0.6391, Th: 0.9525
OOD J Test - Acc: 0.6740, Th: 0.9787
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6799, Th: 0.9735
Fail src: 333/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 156	| table    	| 0.9419	| 0.8108	| 0.9727
 table    	| OOD	| 69	| desk    	| 0.9334	| 0.8218	| 0.9733
 table    	| OOD	| 22	| bed    	| 0.9151	| 0.8052	| 0.9733
 table    	| OOD	| 20	| display    	| 0.9123	| 0.8119	| 0.9666
 display    	| OOD	| 15	| display    	| 0.9612	| 0.9436	| 0.9725
Fail tar: 592/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 137	| desk    	| 0.9863	| 0.9737	| 0.9970
 cabinet    	| ID	| 83	| bed    	| 0.9833	| 0.9738	| 0.9946
 chair    	| ID	| 73	| display    	| 0.9826	| 0.9738	| 0.9954
 chair    	| ID	| 49	| desk    	| 0.9839	| 0.9750	| 0.9967
 sink    	| ID	| 39	| desk    	| 0.9847	| 0.9748	| 0.9938
OOD J Test - Acc: 0.7170, Th: 0.9787
Fail src: 387/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 184	| table    	| 0.9471	| 0.8108	| 0.9784
 table    	| OOD	| 77	| desk    	| 0.9378	| 0.8218	| 0.9775
 table    	| OOD	| 23	| bed    	| 0.9178	| 0.8052	| 0.9761
 table    	| OOD	| 21	| display    	| 0.9154	| 0.8119	| 0.9774
 display    	| OOD	| 20	| display    	| 0.9648	| 0.9436	| 0.9765
Fail tar: 431/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 115	| desk    	| 0.9882	| 0.9788	| 0.9970
 cabinet    	| ID	| 63	| bed    	| 0.9856	| 0.9789	| 0.9946
 chair    	| ID	| 49	| display    	| 0.9856	| 0.9787	| 0.9954
 chair    	| ID	| 39	| desk    	| 0.9858	| 0.9787	| 0.9967
 sink    	| ID	| 31	| desk    	| 0.9870	| 0.9791	| 0.9938
SRC->TAR1:      AUROC: 0.6627, FPR95: 0.9434, AUPR_IN: 0.5841, AUPR_OUT: 0.7011, F1_TH: 0.9525, F1_TH_ACC: 0.5428, J_TH: 0.9787, J_TH_ACC: 0.6716
SRC->TAR2:      AUROC: 0.7193, FPR95: 0.8737, AUPR_IN: 0.7356, AUPR_OUT: 0.6834, F1_TH: 0.9525, F1_TH_ACC: 0.6391, J_TH: 0.9787, J_TH_ACC: 0.6740
SRC->TAR1+TAR2: AUROC: 0.6855, FPR95: 0.9153, AUPR_IN: 0.5008, AUPR_OUT: 0.8164, F1_TH: 0.9735, F1_TH_ACC: 0.6799, J_TH: 0.9787, J_TH_ACC: 0.7170
to spreadsheet: 0.6626913665136409,0.9434262948207172,0.5841126140867787,0.7010970999696757,0.7193468737077413,0.8736717827626919,0.7356212882498046,0.6834216286110917,0.6855206788796748,0.9153187440532826,0.5008067876988029,0.8164328275971001

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713, Clf Bal Acc: 0.2500
Src Test - Fail: 653/788
	A table is predicted as desk - 390 times
	A bed is predicted as desk - 181 times
	A display is predicted as desk - 82 times
Test Tar1
OOD F1 Test - Acc: 0.3872, Th: 0.5639
OOD J Test - Acc: 0.6549, Th: 0.8989
Test Tar2
OOD F1 Test - Acc: 0.4850, Th: 0.5639
OOD J Test - Acc: 0.6502, Th: 0.9064
Test Tar1+Tar2
OOD F1 Test - Acc: 0.5581, Th: 0.8111
Fail src: 264/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 226	| desk    	| 0.7235	| 0.5639	| 0.8103
 display    	| OOD	| 15	| desk    	| 0.7699	| 0.7155	| 0.8042
 bed    	| OOD	| 12	| desk    	| 0.7651	| 0.7118	| 0.8081
 desk    	| OOD	| 11	| desk    	| 0.7810	| 0.7390	| 0.8012
Fail tar: 1013/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 191	| desk    	| 0.9099	| 0.8135	| 0.9899
 chair    	| ID	| 189	| desk    	| 0.8864	| 0.8129	| 0.9696
 cabinet    	| ID	| 141	| desk    	| 0.8697	| 0.8120	| 0.9467
 door    	| ID	| 97	| desk    	| 0.8630	| 0.8111	| 0.9533
 shelf    	| ID	| 75	| desk    	| 0.8565	| 0.8124	| 0.9474
OOD J Test - Acc: 0.7218, Th: 0.9024
Fail src: 474/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 351	| desk    	| 0.7693	| 0.5639	| 0.8993
 bed    	| OOD	| 42	| desk    	| 0.8295	| 0.7118	| 0.9016
 desk    	| OOD	| 41	| desk    	| 0.8394	| 0.7390	| 0.8995
 display    	| OOD	| 40	| desk    	| 0.8267	| 0.7155	| 0.8966
Fail tar: 330/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 114	| desk    	| 0.9441	| 0.9036	| 0.9899
 chair    	| ID	| 68	| desk    	| 0.9352	| 0.9050	| 0.9696
 sink    	| ID	| 33	| desk    	| 0.9351	| 0.9028	| 0.9747
 cabinet    	| ID	| 30	| desk    	| 0.9182	| 0.9027	| 0.9467
 sofa    	| ID	| 25	| desk    	| 0.9393	| 0.9124	| 0.9818
SRC->TAR1:      AUROC: 0.6188, FPR95: 0.9570, AUPR_IN: 0.5286, AUPR_OUT: 0.6699, F1_TH: 0.5639, F1_TH_ACC: 0.3872, J_TH: 0.8989, J_TH_ACC: 0.6549
SRC->TAR2:      AUROC: 0.6620, FPR95: 0.9339, AUPR_IN: 0.6926, AUPR_OUT: 0.6195, F1_TH: 0.5639, F1_TH_ACC: 0.4850, J_TH: 0.9064, J_TH_ACC: 0.6502
SRC->TAR1+TAR2: AUROC: 0.6362, FPR95: 0.9477, AUPR_IN: 0.4413, AUPR_OUT: 0.7842, F1_TH: 0.8111, F1_TH_ACC: 0.5581, J_TH: 0.9024, J_TH_ACC: 0.7218
to spreadsheet: 0.6187958824600076,0.9569721115537848,0.5285518762114667,0.6698531266921341,0.6619735824858113,0.9338842975206612,0.6926236336469715,0.6194874309381505,0.6361943181982834,0.9476688867745005,0.4413400578478095,0.784199871549277
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
OOD F1 Test - Acc: 0.3916, Th: 0.2503
OOD J Test - Acc: 0.6373, Th: 0.2517
Test Tar2
OOD F1 Test - Acc: 0.5229, Th: 0.2505
OOD J Test - Acc: 0.6220, Th: 0.2514
Test Tar1+Tar2
OOD F1 Test - Acc: 0.4699, Th: 0.2510
Fail src: 185/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 95	| table    	| 0.2507	| 0.2502	| 0.2509
 table    	| OOD	| 41	| desk    	| 0.2507	| 0.2501	| 0.2509
 table    	| OOD	| 14	| display    	| 0.2505	| 0.2503	| 0.2508
 table    	| OOD	| 11	| bed    	| 0.2506	| 0.2503	| 0.2509
 display    	| OOD	| 8	| display    	| 0.2508	| 0.2506	| 0.2509
Fail tar: 1347/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 189	| bed    	| 0.2517	| 0.2510	| 0.2529
 toilet    	| ID	| 172	| desk    	| 0.2518	| 0.2510	| 0.2538
 cabinet    	| ID	| 146	| bed    	| 0.2521	| 0.2510	| 0.2541
 chair    	| ID	| 115	| display    	| 0.2514	| 0.2510	| 0.2534
 chair    	| ID	| 93	| desk    	| 0.2514	| 0.2510	| 0.2528
OOD J Test - Acc: 0.6779, Th: 0.2516
Fail src: 440/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 214	| table    	| 0.2510	| 0.2502	| 0.2516
 table    	| OOD	| 87	| desk    	| 0.2510	| 0.2501	| 0.2516
 display    	| OOD	| 39	| display    	| 0.2512	| 0.2506	| 0.2516
 desk    	| OOD	| 24	| desk    	| 0.2513	| 0.2504	| 0.2516
 table    	| OOD	| 18	| display    	| 0.2507	| 0.2503	| 0.2514
Fail tar: 491/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 93	| bed    	| 0.2525	| 0.2516	| 0.2541
 toilet    	| ID	| 91	| desk    	| 0.2521	| 0.2516	| 0.2538
 shelf    	| ID	| 87	| bed    	| 0.2520	| 0.2516	| 0.2529
 sofa    	| ID	| 39	| desk    	| 0.2522	| 0.2517	| 0.2535
 sink    	| ID	| 29	| desk    	| 0.2522	| 0.2517	| 0.2535
SRC->TAR1:      AUROC: 0.6081, FPR95: 0.9363, AUPR_IN: 0.5586, AUPR_OUT: 0.6700, F1_TH: 0.2503, F1_TH_ACC: 0.3916, J_TH: 0.2517, J_TH_ACC: 0.6373
SRC->TAR2:      AUROC: 0.6539, FPR95: 0.8701, AUPR_IN: 0.6255, AUPR_OUT: 0.6502, F1_TH: 0.2505, F1_TH_ACC: 0.5229, J_TH: 0.2514, J_TH_ACC: 0.6220
SRC->TAR1+TAR2: AUROC: 0.6265, FPR95: 0.9096, AUPR_IN: 0.4243, AUPR_OUT: 0.7936, F1_TH: 0.2510, F1_TH_ACC: 0.4699, J_TH: 0.2516, J_TH_ACC: 0.6779
to spreadsheet: 0.6081107043905596,0.9362549800796812,0.5585925604086461,0.6699626156613319,0.6538656889948999,0.8701298701298701,0.6255355633340349,0.6501911183180066,0.6265476558462572,0.9096098953377736,0.4242647247429736,0.7935558003352836
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
OOD F1 Test - Acc: 0.3867, Th: 1.5681
OOD J Test - Acc: 0.6383, Th: 6.6771
Test Tar2
OOD F1 Test - Acc: 0.5376, Th: 2.5523
OOD J Test - Acc: 0.6214, Th: 5.7571
Test Tar1+Tar2
OOD F1 Test - Acc: 0.4689, Th: 3.9266
Fail src: 181/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 93	| table    	| 2.9936	| 1.6366	| 3.8838
 table    	| OOD	| 40	| desk    	| 2.9355	| 1.5681	| 3.7833
 table    	| OOD	| 13	| display    	| 2.4508	| 1.6405	| 3.6356
 table    	| OOD	| 11	| bed    	| 2.8643	| 2.2402	| 3.7994
 display    	| OOD	| 7	| display    	| 3.3744	| 3.0674	| 3.6935
Fail tar: 1354/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 190	| bed    	| 6.6703	| 3.9677	| 11.6895
 toilet    	| ID	| 169	| desk    	| 7.0583	| 3.9907	| 15.1005
 cabinet    	| ID	| 148	| bed    	| 8.2816	| 3.9650	| 16.3642
 chair    	| ID	| 114	| display    	| 5.8005	| 3.9770	| 13.3483
 chair    	| ID	| 92	| desk    	| 5.8424	| 4.0018	| 11.1503
OOD J Test - Acc: 0.6820, Th: 6.6771
Fail src: 444/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 214	| table    	| 4.1488	| 1.6366	| 6.6314
 table    	| OOD	| 88	| desk    	| 4.2682	| 1.5681	| 6.6304
 display    	| OOD	| 39	| display    	| 4.8353	| 3.0674	| 6.3811
 desk    	| OOD	| 25	| desk    	| 5.3643	| 2.2700	| 6.6311
 bed    	| OOD	| 18	| bed    	| 4.4503	| 2.5882	| 6.6394
Fail tar: 475/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 93	| bed    	| 10.0501	| 6.6904	| 16.3642
 toilet    	| ID	| 86	| desk    	| 8.6243	| 6.7020	| 15.1005
 shelf    	| ID	| 82	| bed    	| 8.1904	| 6.6800	| 11.6895
 sofa    	| ID	| 38	| desk    	| 9.0322	| 6.7717	| 13.9905
 sink    	| ID	| 28	| desk    	| 8.9476	| 6.8391	| 13.7495
SRC->TAR1:      AUROC: 0.6068, FPR95: 0.9315, AUPR_IN: 0.5582, AUPR_OUT: 0.6666, F1_TH: 1.5681, F1_TH_ACC: 0.3867, J_TH: 6.6771, J_TH_ACC: 0.6383
SRC->TAR2:      AUROC: 0.6537, FPR95: 0.8571, AUPR_IN: 0.6245, AUPR_OUT: 0.6516, F1_TH: 2.5523, F1_TH_ACC: 0.5376, J_TH: 5.7571, J_TH_ACC: 0.6214
SRC->TAR1+TAR2: AUROC: 0.6257, FPR95: 0.9015, AUPR_IN: 0.4234, AUPR_OUT: 0.7926, F1_TH: 3.9266, F1_TH_ACC: 0.4689, J_TH: 6.6771, J_TH_ACC: 0.6820
to spreadsheet: 0.6068204340000405,0.9314741035856574,0.558201261296418,0.6665973680173064,0.653709119675894,0.8571428571428571,0.6244861497065903,0.6516063301739609,0.6257142098170947,0.9015223596574691,0.4234093750910395,0.792642997871495
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6128, Th: 450.1841
OOD J Test - Acc: 0.6353, Th: 270.1729
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5131, Th: 446.1618
OOD J Test - Acc: 0.6135, Th: 173.0612
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7235, Th: 446.1618
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 256	| table    	| 163.8386	| 38.7745	| 315.2933
 bed    	| OOD	| 177	| bed    	| 285.8749	| 98.0488	| 431.8893
 desk    	| OOD	| 118	| desk    	| 228.7364	| 68.7366	| 445.2519
 table    	| OOD	| 100	| desk    	| 147.3770	| 29.6186	| 333.5762
 display    	| OOD	| 69	| display    	| 185.6007	| 90.2671	| 391.9947
Fail tar: 11/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 7	| bed    	| 478.7341	| 463.7270	| 510.3802
 door    	| ID	| 3	| table    	| 463.3490	| 450.1841	| 474.3483
 cabinet    	| ID	| 1	| table    	| 446.1618	| 446.1618	| 446.1618
OOD J Test - Acc: 0.5626, Th: 173.8001
Fail src: 321/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 146	| table    	| 126.5158	| 38.7745	| 172.7259
 table    	| OOD	| 71	| desk    	| 122.8662	| 29.6186	| 173.5773
 display    	| OOD	| 30	| display    	| 138.0362	| 90.2671	| 171.2766
 table    	| OOD	| 16	| display    	| 89.5351	| 54.1162	| 153.8904
 table    	| OOD	| 14	| bed    	| 102.8417	| 57.7867	| 156.4716
Fail tar: 943/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 186	| bed    	| 247.1490	| 175.9165	| 325.5376
 toilet    	| ID	| 127	| desk    	| 229.9547	| 175.0848	| 373.3289
 cabinet    	| ID	| 117	| bed    	| 293.2889	| 174.6594	| 510.3802
 chair    	| ID	| 52	| display    	| 215.8101	| 174.0847	| 370.5080
 chair    	| ID	| 52	| desk    	| 206.6564	| 173.9979	| 317.6262
SRC->TAR1:      AUROC: 0.5610, FPR95: 0.9378, AUPR_IN: 0.4647, AUPR_OUT: 0.6491, F1_TH: 450.1841, F1_TH_ACC: 0.6128, J_TH: 270.1729, J_TH_ACC: 0.6353
SRC->TAR2:      AUROC: 0.6381, FPR95: 0.8571, AUPR_IN: 0.5725, AUPR_OUT: 0.6533, F1_TH: 446.1618, F1_TH_ACC: 0.5131, J_TH: 173.0612, J_TH_ACC: 0.6135
SRC->TAR1+TAR2: AUROC: 0.5921, FPR95: 0.9053, AUPR_IN: 0.3419, AUPR_OUT: 0.7852, F1_TH: 446.1618, F1_TH_ACC: 0.7235, J_TH: 173.8001, J_TH_ACC: 0.5626
to spreadsheet: 0.5610330252593686,0.9378486055776892,0.4646502530326237,0.6490578953401274,0.6381106203441229,0.8571428571428571,0.5725351589792053,0.6532611665594835,0.5920914091969457,0.9053282588011418,0.34189243464957175,0.7851628967979467
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
React Val - adding corrupted synthetic data: all
get_list_corr_data for modelnet_set2 - split test
loading both lidar and occlusion data
corr list files: ['/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev4.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev4.h5']

Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev1.h5 datas: (486, 768, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev2.h5 datas: (486, 768, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev3.h5 datas: (486, 768, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set2_test_lidar_sev4.h5 datas: (486, 768, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev1.h5 datas: (486, 1024, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev2.h5 datas: (486, 1024, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev3.h5 datas: (486, 1024, 3), labels: (486,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set2_test_occlusion_sev4.h5 datas: (486, 1024, 3), labels: (486,)
React Val - cumulative (clean+corrupted) data len: 4374

Estimating react threshold...
t = 0.3749
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=0.3749)...
React - using SR2 test to compute threshold



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7868, Clf Bal Acc: 0.8375
Src Test - Fail: 168/788
	A table is predicted as desk - 100 times
	A table is predicted as display - 18 times
	A desk is predicted as table - 17 times
	A table is predicted as bed - 16 times
	A display is predicted as desk - 11 times
Test Tar1
OOD F1 Test - Acc: 0.3872, Th: 1.5715
OOD J Test - Acc: 0.6490, Th: 6.9198
Test Tar2
OOD F1 Test - Acc: 0.5376, Th: 2.5523
OOD J Test - Acc: 0.6251, Th: 6.0670
Test Tar1+Tar2
OOD F1 Test - Acc: 0.4696, Th: 3.9266
Fail src: 181/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 93	| table    	| 2.9945	| 1.6366	| 3.8838
 table    	| OOD	| 40	| desk    	| 2.9352	| 1.5715	| 3.7868
 table    	| OOD	| 13	| display    	| 2.4497	| 1.6405	| 3.6345
 table    	| OOD	| 11	| bed    	| 2.8645	| 2.2390	| 3.7994
 display    	| OOD	| 7	| display    	| 3.3751	| 3.0681	| 3.6935
Fail tar: 1352/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 190	| bed    	| 6.4196	| 3.9646	| 9.7898
 toilet    	| ID	| 169	| desk    	| 7.0282	| 3.9907	| 14.2081
 cabinet    	| ID	| 148	| bed    	| 7.2297	| 3.9480	| 10.7200
 chair    	| ID	| 113	| display    	| 5.7272	| 4.0293	| 12.2370
 chair    	| ID	| 92	| desk    	| 5.7457	| 4.0018	| 10.8298
OOD J Test - Acc: 0.6851, Th: 6.6073
Fail src: 440/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| OOD	| 213	| table    	| 4.1358	| 1.6366	| 6.5519
 table    	| OOD	| 87	| desk    	| 4.2397	| 1.5715	| 6.5235
 display    	| OOD	| 40	| display    	| 4.8441	| 3.0681	| 6.4454
 desk    	| OOD	| 24	| desk    	| 5.3113	| 2.2700	| 6.5683
 table    	| OOD	| 18	| display    	| 3.0520	| 1.6405	| 5.8067
Fail tar: 470/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 toilet    	| ID	| 89	| desk    	| 8.5029	| 6.6100	| 14.2081
 cabinet    	| ID	| 87	| bed    	| 8.5429	| 6.6794	| 10.7200
 shelf    	| ID	| 79	| bed    	| 7.8086	| 6.6268	| 9.7898
 sofa    	| ID	| 38	| desk    	| 8.8861	| 6.6695	| 13.7364
 sink    	| ID	| 29	| desk    	| 8.7447	| 6.6300	| 13.0659
SRC->TAR1:      AUROC: 0.6087, FPR95: 0.9315, AUPR_IN: 0.5345, AUPR_OUT: 0.6681, F1_TH: 1.5715, F1_TH_ACC: 0.3872, J_TH: 6.9198, J_TH_ACC: 0.6490
SRC->TAR2:      AUROC: 0.6614, FPR95: 0.8595, AUPR_IN: 0.6553, AUPR_OUT: 0.6546, F1_TH: 2.5523, F1_TH_ACC: 0.5376, J_TH: 6.0670, J_TH_ACC: 0.6251
SRC->TAR1+TAR2: AUROC: 0.6299, FPR95: 0.9025, AUPR_IN: 0.4283, AUPR_OUT: 0.7941, F1_TH: 3.9266, F1_TH_ACC: 0.4696, J_TH: 6.6073, J_TH_ACC: 0.6851
to spreadsheet: 0.608723481707687,0.9314741035856574,0.5344624239329798,0.6680736460312111,0.661392253339646,0.859504132231405,0.6553458413182639,0.6546323101593694,0.6299463406859311,0.9024738344433872,0.42830369097782794,0.7941394860876679
################################################################################
