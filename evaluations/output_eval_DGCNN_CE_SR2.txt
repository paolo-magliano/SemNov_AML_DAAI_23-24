Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='/content/3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR2', eval_step=1, save_step=10, ckpt_path='/content/SemNov_AML_DAAI_23-24/trained_models/DGCNN_CE_SR2.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', wandb_api=None, loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, open_shape=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 400, 1: 401, 2: 402, 3: 403, 11: 404}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 4, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8001 M
Load weights:  <All keys matched successfully>



Src logits: torch.Size([788, 4]), tar1 logits: torch.Size([1255, 4]), tar2 logits: torch.Size([847, 4])
Src pred: torch.Size([788]), tar1 pred: torch.Size([1255]), tar2 pred: torch.Size([847])
Src labels: torch.Size([788]), tar1 labels: torch.Size([1255]), tar2 labels: torch.Size([847])
Src: ['bed', 'toilet', 'desk', 'display', 'table']
Tar1: ['chair', 'shelf', 'door', 'sink', 'sofa']
Tar2: ['bag', 'bin', 'box', 'cabinet', 'pillow']

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
OOD F1 Test - Acc: 0.4547, Th: 0.6483
OOD J Test - Acc: 0.5673, Th: 0.9337
Test Tar2
OOD F1 Test - Acc: 0.5462, Th: 0.6376
OOD J Test - Acc: 0.6031, Th: 0.9355
Test Tar1+Tar2
OOD F1 Test - Acc: 0.5415, Th: 0.9197
Fail src: 231/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 67	| desk    	| 0.7366	| 0.5006	| 0.9132
 desk    	| OOD	| 52	| bed    	| 0.7214	| 0.3228	| 0.9039
 toilet    	| OOD	| 23	| desk    	| 0.7314	| 0.4740	| 0.8636
 display    	| OOD	| 20	| display    	| 0.7598	| 0.5498	| 0.9008
 bed    	| OOD	| 18	| desk    	| 0.7536	| 0.4465	| 0.9176
Fail tar: 1094/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 207	| display    	| 0.9965	| 0.9282	| 1.0000
 cabinet    	| ID	| 139	| display    	| 0.9892	| 0.9203	| 1.0000
 chair    	| ID	| 137	| desk    	| 0.9865	| 0.9259	| 1.0000
 cabinet    	| ID	| 88	| desk    	| 0.9839	| 0.9263	| 1.0000
 shelf    	| ID	| 75	| desk    	| 0.9726	| 0.9203	| 1.0000
OOD J Test - Acc: 0.5578, Th: 0.9355
Fail src: 254/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 72	| desk    	| 0.7495	| 0.5006	| 0.9258
 desk    	| OOD	| 58	| bed    	| 0.7428	| 0.3228	| 0.9342
 toilet    	| OOD	| 23	| desk    	| 0.7314	| 0.4740	| 0.8636
 display    	| OOD	| 21	| display    	| 0.7679	| 0.5498	| 0.9291
 bed    	| OOD	| 20	| desk    	| 0.7709	| 0.4465	| 0.9313
Fail tar: 1024/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 205	| display    	| 0.9972	| 0.9512	| 1.0000
 cabinet    	| ID	| 132	| display    	| 0.9925	| 0.9455	| 1.0000
 chair    	| ID	| 132	| desk    	| 0.9887	| 0.9390	| 1.0000
 cabinet    	| ID	| 85	| desk    	| 0.9858	| 0.9398	| 1.0000
 shelf    	| ID	| 68	| desk    	| 0.9773	| 0.9382	| 1.0000
SRC->TAR1:      AUROC: 0.5972, FPR95: 0.8948, AUPR_IN: 0.4651, AUPR_OUT: 0.6935, F1_TH: 0.6483, F1_TH_ACC: 0.4547, J_TH: 0.9337, J_TH_ACC: 0.5673
SRC->TAR2:      AUROC: 0.6435, FPR95: 0.8642, AUPR_IN: 0.6158, AUPR_OUT: 0.6418, F1_TH: 0.6376, F1_TH_ACC: 0.5462, J_TH: 0.9355, J_TH_ACC: 0.6031
SRC->TAR1+TAR2: AUROC: 0.6159, FPR95: 0.8825, AUPR_IN: 0.3626, AUPR_OUT: 0.8002, F1_TH: 0.9197, F1_TH_ACC: 0.5415, J_TH: 0.9355, J_TH_ACC: 0.5578
to spreadsheet: 0.5972162112969441,0.8948207171314742,0.4651405252911034,0.6935406250364755,0.6434669391522184,0.8642266824085005,0.6157793550620797,0.6418169668842785,0.6158529222833463,0.8824928639391056,0.36261336956159723,0.8001964750712455
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 19.1245
OOD J Test - Acc: 0.5932, Th: 4.0394
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 18.8499
OOD J Test - Acc: 0.5706, Th: 5.5787
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7266, Th: 18.8499
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 286	| desk    	| 6.3020	| 1.4849	| 17.4136
 display    	| OOD	| 165	| display    	| 7.5940	| 1.8120	| 12.1153
 desk    	| OOD	| 96	| bed    	| 4.2713	| 0.3226	| 9.9756
 bed    	| OOD	| 79	| bed    	| 6.5292	| 3.1392	| 11.7940
 bed    	| OOD	| 55	| desk    	| 5.7551	| 2.2704	| 13.2493
Fail tar: 2/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 1	| desk    	| 19.1245	| 19.1245	| 19.1245
 cabinet    	| ID	| 1	| desk    	| 18.8499	| 18.8499	| 18.8499
OOD J Test - Acc: 0.5540, Th: 4.4508
Fail src: 250/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 84	| desk    	| 3.1168	| 1.4849	| 4.2721
 desk    	| OOD	| 61	| bed    	| 3.1770	| 0.3226	| 4.3990
 toilet    	| OOD	| 30	| desk    	| 2.9354	| 1.1423	| 4.3636
 bed    	| OOD	| 14	| desk    	| 3.3833	| 2.2704	| 4.2022
 toilet    	| OOD	| 14	| toilet    	| 2.5107	| 0.6659	| 4.3506
Fail tar: 1039/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 213	| display    	| 8.1915	| 4.4537	| 10.9805
 cabinet    	| ID	| 165	| display    	| 7.7140	| 4.4607	| 13.1154
 cabinet    	| ID	| 113	| desk    	| 6.7233	| 4.5340	| 18.8499
 chair    	| ID	| 111	| desk    	| 7.3738	| 4.4852	| 19.1245
 shelf    	| ID	| 53	| desk    	| 6.3463	| 4.4558	| 10.6636
SRC->TAR1:      AUROC: 0.6341, FPR95: 0.8645, AUPR_IN: 0.4927, AUPR_OUT: 0.7279, F1_TH: 19.1245, F1_TH_ACC: 0.6138, J_TH: 4.0394, J_TH_ACC: 0.5932
SRC->TAR2:      AUROC: 0.5946, FPR95: 0.8843, AUPR_IN: 0.5637, AUPR_OUT: 0.6086, F1_TH: 18.8499, F1_TH_ACC: 0.5174, J_TH: 5.5787, J_TH_ACC: 0.5706
SRC->TAR1+TAR2: AUROC: 0.6182, FPR95: 0.8725, AUPR_IN: 0.3577, AUPR_OUT: 0.8066, F1_TH: 18.8499, F1_TH_ACC: 0.7266, J_TH: 4.4508, J_TH_ACC: 0.5540
to spreadsheet: 0.6341264384088013,0.8645418326693227,0.4927302626223439,0.7278795378815133,0.5945843496604918,0.8842975206611571,0.5637126710583333,0.6086389241667942,0.618192970678155,0.8725023786869648,0.3577146821635579,0.8066106073574587
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6133, Th: 49051468.0000
OOD J Test - Acc: 0.5678, Th: 14.1987
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 37329888.0000
OOD J Test - Acc: 0.6018, Th: 14.1987
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7263, Th: 37329888.0000
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 286	| desk    	| 114480.9212	| 3.7962	| 27459826.0000
 display    	| OOD	| 165	| display    	| 2561.8798	| 4.9935	| 63598.6211
 desk    	| OOD	| 96	| bed    	| 174.3144	| 2.9793	| 7612.8306
 bed    	| OOD	| 79	| bed    	| 8194.5184	| 4.7589	| 137090.9375
 bed    	| OOD	| 55	| desk    	| 2746.0128	| 4.0174	| 111981.5781
Fail tar: 3/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 2	| desk    	| 193393158.0000	| 49051468.0000	| 337734848.0000
 cabinet    	| ID	| 1	| desk    	| 37329888.0000	| 37329888.0000	| 37329888.0000
OOD J Test - Acc: 0.5526, Th: 14.1987
Fail src: 241/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 71	| desk    	| 7.1976	| 3.7962	| 13.5958
 desk    	| OOD	| 54	| bed    	| 6.9212	| 2.9793	| 13.5040
 toilet    	| OOD	| 23	| desk    	| 6.3521	| 3.5906	| 8.6406
 display    	| OOD	| 20	| display    	| 7.8351	| 4.9935	| 12.3618
 bed    	| OOD	| 18	| desk    	| 7.7233	| 4.0174	| 13.4263
Fail tar: 1052/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 207	| display    	| 2374.5327	| 14.8140	| 34820.8594
 cabinet    	| ID	| 138	| display    	| 5970.9721	| 14.6139	| 304824.7812
 chair    	| ID	| 131	| desk    	| 2973057.5978	| 15.4369	| 337734848.0000
 cabinet    	| ID	| 88	| desk    	| 424695.7664	| 15.0907	| 37329888.0000
 shelf    	| ID	| 72	| desk    	| 937.7047	| 14.3869	| 25392.4316
SRC->TAR1:      AUROC: 0.6028, FPR95: 0.8853, AUPR_IN: 0.4664, AUPR_OUT: 0.7036, F1_TH: 49051468.0000, F1_TH_ACC: 0.6133, J_TH: 14.1987, J_TH_ACC: 0.5678
SRC->TAR2:      AUROC: 0.6414, FPR95: 0.8819, AUPR_IN: 0.6135, AUPR_OUT: 0.6376, F1_TH: 37329888.0000, F1_TH_ACC: 0.5174, J_TH: 14.1987, J_TH_ACC: 0.6018
SRC->TAR1+TAR2: AUROC: 0.6183, FPR95: 0.8839, AUPR_IN: 0.3623, AUPR_OUT: 0.8035, F1_TH: 37329888.0000, F1_TH_ACC: 0.7263, J_TH: 14.1987, J_TH_ACC: 0.5526
to spreadsheet: 0.6027524420086152,0.8852589641434263,0.46635983736317116,0.7035999420161522,0.6414143078886965,0.8819362455726092,0.6135372329499461,0.6376331209221969,0.6183312243113882,0.8839200761179828,0.36233012637731304,0.8035089965248581
################################################################################

################################################################################
Computing OOD metrics with distance from train features...

  warnings.warn(_create_warning_msg(




Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7157, Clf Bal Acc: 0.6250
Src Test - Fail: 224/788
	A desk is predicted as bed - 81 times
	A toilet is predicted as desk - 50 times
	A bed is predicted as desk - 44 times
	A desk is predicted as display - 15 times
	A display is predicted as desk - 13 times
Test Tar1
OOD F1 Test - Acc: 0.4998, Th: 0.0943
OOD J Test - Acc: 0.6148, Th: 0.1192
Test Tar2
OOD F1 Test - Acc: 0.6092, Th: 0.0923
OOD J Test - Acc: 0.6404, Th: 0.1037
Test Tar1+Tar2
OOD F1 Test - Acc: 0.5495, Th: 0.1037
Fail src: 200/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 54	| desk    	| 0.0912	| 0.0737	| 0.1030
 desk    	| OOD	| 32	| bed    	| 0.0914	| 0.0745	| 0.1031
 bed    	| OOD	| 28	| bed    	| 0.0899	| 0.0704	| 0.1031
 toilet    	| OOD	| 19	| desk    	| 0.0908	| 0.0716	| 0.1015
 bed    	| OOD	| 17	| desk    	| 0.0860	| 0.0631	| 0.1014
Fail tar: 1102/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 185	| desk    	| 0.1382	| 0.1044	| 0.2375
 cabinet    	| ID	| 142	| display    	| 0.1489	| 0.1037	| 0.2741
 door    	| ID	| 121	| display    	| 0.1364	| 0.1038	| 0.2225
 sofa    	| ID	| 84	| desk    	| 0.1352	| 0.1038	| 0.2190
 shelf    	| ID	| 78	| desk    	| 0.1384	| 0.1039	| 0.2744
OOD J Test - Acc: 0.6346, Th: 0.1189
Fail src: 321/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 87	| desk    	| 0.0988	| 0.0737	| 0.1185
 desk    	| OOD	| 50	| bed    	| 0.0981	| 0.0745	| 0.1184
 bed    	| OOD	| 42	| bed    	| 0.0965	| 0.0704	| 0.1181
 toilet    	| OOD	| 36	| desk    	| 0.1000	| 0.0716	| 0.1179
 display    	| OOD	| 31	| display    	| 0.1037	| 0.0800	| 0.1186
Fail tar: 735/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 127	| desk    	| 0.1510	| 0.1190	| 0.2375
 cabinet    	| ID	| 106	| display    	| 0.1618	| 0.1190	| 0.2741
 door    	| ID	| 85	| display    	| 0.1474	| 0.1190	| 0.2225
 sofa    	| ID	| 57	| desk    	| 0.1468	| 0.1195	| 0.2190
 cabinet    	| ID	| 54	| desk    	| 0.1475	| 0.1206	| 0.2362
SRC->TAR1:      AUROC: 0.6447, FPR95: 0.9155, AUPR_IN: 0.5538, AUPR_OUT: 0.7101, F1_TH: 0.0943, F1_TH_ACC: 0.4998, J_TH: 0.1192, J_TH_ACC: 0.6148
SRC->TAR2:      AUROC: 0.6912, FPR95: 0.8312, AUPR_IN: 0.6555, AUPR_OUT: 0.7003, F1_TH: 0.0923, F1_TH_ACC: 0.6092, J_TH: 0.1037, J_TH_ACC: 0.6404
SRC->TAR1+TAR2: AUROC: 0.6634, FPR95: 0.8815, AUPR_IN: 0.4354, AUPR_OUT: 0.8242, F1_TH: 0.1037, F1_TH_ACC: 0.5495, J_TH: 0.1189, J_TH_ACC: 0.6346
to spreadsheet: 0.6447175763949279,0.9155378486055777,0.5538118701141124,0.7101435061894535,0.6911531592542206,0.8311688311688312,0.655530929073554,0.7003402383811971,0.6634287746260511,0.8815413891531875,0.435413393275558,0.8242101239050803

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713, Clf Bal Acc: 0.2500
Src Test - Fail: 653/788
	A desk is predicted as bed - 390 times
	A display is predicted as bed - 181 times
	A toilet is predicted as bed - 82 times
Test Tar1
OOD F1 Test - Acc: 0.4180, Th: 0.0350
OOD J Test - Acc: 0.5967, Th: 0.0446
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 0.2465
OOD J Test - Acc: 0.5761, Th: 0.0505
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7270, Th: 0.2465
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 390	| bed    	| 0.0473	| 0.0292	| 0.1707
 display    	| OOD	| 181	| bed    	| 0.0598	| 0.0357	| 0.1309
 bed    	| OOD	| 135	| bed    	| 0.0498	| 0.0311	| 0.1420
 toilet    	| OOD	| 82	| bed    	| 0.0406	| 0.0338	| 0.0569
Fail tar: 1/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bag    	| ID	| 1	| bed    	| 0.2465	| 0.2465	| 0.2465
OOD J Test - Acc: 0.6713, Th: 0.0505
Fail src: 507/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 277	| bed    	| 0.0399	| 0.0292	| 0.0503
 bed    	| OOD	| 86	| bed    	| 0.0404	| 0.0311	| 0.0503
 toilet    	| OOD	| 77	| bed    	| 0.0397	| 0.0338	| 0.0488
 display    	| OOD	| 67	| bed    	| 0.0439	| 0.0357	| 0.0502
Fail tar: 443/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 116	| bed    	| 0.0646	| 0.0506	| 0.1018
 door    	| ID	| 106	| bed    	| 0.0615	| 0.0506	| 0.1287
 chair    	| ID	| 67	| bed    	| 0.0633	| 0.0507	| 0.1040
 sink    	| ID	| 37	| bed    	| 0.0639	| 0.0510	| 0.1152
 bag    	| ID	| 29	| bed    	| 0.0657	| 0.0509	| 0.2465
SRC->TAR1:      AUROC: 0.5890, FPR95: 0.9219, AUPR_IN: 0.4929, AUPR_OUT: 0.6639, F1_TH: 0.0350, F1_TH_ACC: 0.4180, J_TH: 0.0446, J_TH_ACC: 0.5967
SRC->TAR2:      AUROC: 0.5536, FPR95: 0.9587, AUPR_IN: 0.5594, AUPR_OUT: 0.5302, F1_TH: 0.2465, F1_TH_ACC: 0.5174, J_TH: 0.0505, J_TH_ACC: 0.5761
SRC->TAR1+TAR2: AUROC: 0.5747, FPR95: 0.9367, AUPR_IN: 0.3598, AUPR_OUT: 0.7553, F1_TH: 0.2465, F1_TH_ACC: 0.7270, J_TH: 0.0505, J_TH_ACC: 0.6713
to spreadsheet: 0.5889750642101644,0.9219123505976096,0.4928564786329851,0.663926178189459,0.5535991465848411,0.9586776859504132,0.5594160610858416,0.530239845626578,0.5747203533497225,0.9367269267364415,0.3598253341620963,0.7552899349218145

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7030, Clf Bal Acc: 0.6337
Src Test - Fail: 234/788
	A desk is predicted as bed - 97 times
	A bed is predicted as desk - 47 times
	A toilet is predicted as desk - 42 times
	A toilet is predicted as bed - 12 times
	A desk is predicted as display - 11 times
Test Tar1
OOD F1 Test - Acc: 0.5830, Th: 0.9432
OOD J Test - Acc: 0.6490, Th: 0.9626
Test Tar2
OOD F1 Test - Acc: 0.5817, Th: 0.9259
OOD J Test - Acc: 0.6287, Th: 0.9631
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6336, Th: 0.9604
Fail src: 288/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 78	| desk    	| 0.9254	| 0.8378	| 0.9596
 desk    	| OOD	| 56	| bed    	| 0.9174	| 0.8081	| 0.9591
 bed    	| OOD	| 33	| bed    	| 0.9337	| 0.8928	| 0.9588
 toilet    	| OOD	| 29	| desk    	| 0.9210	| 0.8478	| 0.9597
 bed    	| OOD	| 21	| desk    	| 0.9346	| 0.8581	| 0.9589
Fail tar: 771/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 132	| display    	| 0.9793	| 0.9608	| 0.9967
 door    	| ID	| 124	| display    	| 0.9767	| 0.9606	| 0.9921
 chair    	| ID	| 91	| desk    	| 0.9809	| 0.9613	| 0.9968
 cabinet    	| ID	| 67	| desk    	| 0.9784	| 0.9614	| 0.9960
 shelf    	| ID	| 43	| desk    	| 0.9777	| 0.9607	| 0.9963
OOD J Test - Acc: 0.6509, Th: 0.9633
Fail src: 312/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 85	| desk    	| 0.9284	| 0.8378	| 0.9626
 desk    	| OOD	| 60	| bed    	| 0.9203	| 0.8081	| 0.9628
 bed    	| OOD	| 35	| bed    	| 0.9353	| 0.8928	| 0.9632
 toilet    	| OOD	| 29	| desk    	| 0.9210	| 0.8478	| 0.9597
 display    	| OOD	| 24	| display    	| 0.9415	| 0.8832	| 0.9631
Fail tar: 697/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 120	| display    	| 0.9811	| 0.9643	| 0.9967
 door    	| ID	| 114	| display    	| 0.9780	| 0.9636	| 0.9921
 chair    	| ID	| 88	| desk    	| 0.9815	| 0.9636	| 0.9968
 cabinet    	| ID	| 62	| desk    	| 0.9797	| 0.9634	| 0.9960
 sink    	| ID	| 38	| bed    	| 0.9793	| 0.9647	| 0.9924
SRC->TAR1:      AUROC: 0.6791, FPR95: 0.9219, AUPR_IN: 0.5930, AUPR_OUT: 0.7324, F1_TH: 0.9432, F1_TH_ACC: 0.5830, J_TH: 0.9626, J_TH_ACC: 0.6490
SRC->TAR2:      AUROC: 0.6704, FPR95: 0.8867, AUPR_IN: 0.6649, AUPR_OUT: 0.6608, F1_TH: 0.9259, F1_TH_ACC: 0.5817, J_TH: 0.9631, J_TH_ACC: 0.6287
SRC->TAR1+TAR2: AUROC: 0.6756, FPR95: 0.9077, AUPR_IN: 0.4703, AUPR_OUT: 0.8232, F1_TH: 0.9604, F1_TH_ACC: 0.6336, J_TH: 0.9633, J_TH_ACC: 0.6509
to spreadsheet: 0.6790700143588084,0.9219123505976096,0.5930091263946292,0.7323824488662242,0.6704133430021755,0.8866587957497049,0.6648692815311709,0.6607529895838138,0.6755818123421252,0.9077069457659372,0.47031329561529917,0.8232121927938056

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713, Clf Bal Acc: 0.2500
Src Test - Fail: 653/788
	A desk is predicted as bed - 390 times
	A display is predicted as bed - 181 times
	A toilet is predicted as bed - 82 times
Test Tar1
OOD F1 Test - Acc: 0.4812, Th: 0.7705
OOD J Test - Acc: 0.6304, Th: 0.8914
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 0.9958
OOD J Test - Acc: 0.6122, Th: 0.8724
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7270, Th: 0.9958
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 390	| bed    	| 0.8691	| 0.6428	| 0.9952
 display    	| OOD	| 181	| bed    	| 0.8846	| 0.7198	| 0.9920
 bed    	| OOD	| 135	| bed    	| 0.8701	| 0.6807	| 0.9904
 toilet    	| OOD	| 82	| bed    	| 0.8163	| 0.6048	| 0.9663
Fail tar: 1/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bag    	| ID	| 1	| bed    	| 0.9958	| 0.9958	| 0.9958
OOD J Test - Acc: 0.6682, Th: 0.8914
Fail src: 430/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 205	| bed    	| 0.7981	| 0.6428	| 0.8888
 display    	| OOD	| 89	| bed    	| 0.8290	| 0.7198	| 0.8868
 bed    	| OOD	| 71	| bed    	| 0.8084	| 0.6807	| 0.8856
 toilet    	| OOD	| 65	| bed    	| 0.7902	| 0.6048	| 0.8887
Fail tar: 529/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 127	| bed    	| 0.9333	| 0.8917	| 0.9909
 cabinet    	| ID	| 123	| bed    	| 0.9260	| 0.8921	| 0.9749
 sofa    	| ID	| 60	| bed    	| 0.9302	| 0.8919	| 0.9824
 door    	| ID	| 55	| bed    	| 0.9212	| 0.8918	| 0.9837
 sink    	| ID	| 44	| bed    	| 0.9335	| 0.8949	| 0.9797
SRC->TAR1:      AUROC: 0.6238, FPR95: 0.9315, AUPR_IN: 0.5380, AUPR_OUT: 0.6916, F1_TH: 0.7705, F1_TH_ACC: 0.4812, J_TH: 0.8914, J_TH_ACC: 0.6304
SRC->TAR2:      AUROC: 0.6393, FPR95: 0.9492, AUPR_IN: 0.6549, AUPR_OUT: 0.6043, F1_TH: 0.9958, F1_TH_ACC: 0.5174, J_TH: 0.8724, J_TH_ACC: 0.6122
SRC->TAR1+TAR2: AUROC: 0.6301, FPR95: 0.9386, AUPR_IN: 0.4315, AUPR_OUT: 0.7903, F1_TH: 0.9958, F1_TH_ACC: 0.7270, J_TH: 0.8914, J_TH_ACC: 0.6682
to spreadsheet: 0.6238437114486218,0.9314741035856574,0.5379844921636192,0.6915506882913248,0.6392807699914299,0.9492325855962219,0.6549401755536663,0.6042659555877479,0.6300640675788589,0.9386298763082779,0.4314844808558328,0.7902615722755185
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...

  warnings.warn(_create_warning_msg(



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 0.2548
OOD J Test - Acc: 0.5928, Th: 0.2510
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 0.2547
OOD J Test - Acc: 0.5725, Th: 0.2514
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7266, Th: 0.2547
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 286	| desk    	| 0.2516	| 0.2504	| 0.2543
 display    	| OOD	| 165	| display    	| 0.2519	| 0.2504	| 0.2530
 desk    	| OOD	| 96	| bed    	| 0.2511	| 0.2501	| 0.2525
 bed    	| OOD	| 79	| bed    	| 0.2516	| 0.2508	| 0.2530
 bed    	| OOD	| 55	| desk    	| 0.2514	| 0.2506	| 0.2533
Fail tar: 2/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 1	| desk    	| 0.2548	| 0.2548	| 0.2548
 cabinet    	| ID	| 1	| desk    	| 0.2547	| 0.2547	| 0.2547
OOD J Test - Acc: 0.5550, Th: 0.2511
Fail src: 250/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 84	| desk    	| 0.2508	| 0.2504	| 0.2511
 desk    	| OOD	| 61	| bed    	| 0.2508	| 0.2501	| 0.2511
 toilet    	| OOD	| 30	| desk    	| 0.2507	| 0.2503	| 0.2511
 bed    	| OOD	| 14	| desk    	| 0.2508	| 0.2506	| 0.2510
 toilet    	| OOD	| 14	| toilet    	| 0.2506	| 0.2502	| 0.2511
Fail tar: 1036/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 212	| display    	| 0.2520	| 0.2511	| 0.2527
 cabinet    	| ID	| 164	| display    	| 0.2519	| 0.2511	| 0.2533
 cabinet    	| ID	| 113	| desk    	| 0.2517	| 0.2511	| 0.2547
 chair    	| ID	| 112	| desk    	| 0.2518	| 0.2511	| 0.2548
 shelf    	| ID	| 52	| desk    	| 0.2516	| 0.2511	| 0.2527
SRC->TAR1:      AUROC: 0.6338, FPR95: 0.8645, AUPR_IN: 0.4924, AUPR_OUT: 0.7275, F1_TH: 0.2548, F1_TH_ACC: 0.6138, J_TH: 0.2510, J_TH_ACC: 0.5928
SRC->TAR2:      AUROC: 0.5960, FPR95: 0.8843, AUPR_IN: 0.5652, AUPR_OUT: 0.6095, F1_TH: 0.2547, F1_TH_ACC: 0.5174, J_TH: 0.2514, J_TH_ACC: 0.5725
SRC->TAR1+TAR2: AUROC: 0.6186, FPR95: 0.8725, AUPR_IN: 0.3582, AUPR_OUT: 0.8067, F1_TH: 0.2547, F1_TH_ACC: 0.7266, J_TH: 0.2511, J_TH_ACC: 0.5550
to spreadsheet: 0.6338033652193257,0.8645418326693227,0.4924178703107473,0.7274501964202427,0.5959837347700754,0.8842975206611571,0.5651530565239545,0.6095136024109642,0.6185639613227915,0.8725023786869648,0.3581608914608766,0.8066605756779655
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...

  warnings.warn(_create_warning_msg(



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 19.1245
OOD J Test - Acc: 0.5932, Th: 4.1284
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 18.8499
OOD J Test - Acc: 0.5651, Th: 5.4059
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7266, Th: 18.8499
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 286	| desk    	| 6.3861	| 1.9277	| 17.4142
 display    	| OOD	| 165	| display    	| 7.6365	| 2.1102	| 12.1154
 desk    	| OOD	| 96	| bed    	| 4.4707	| 1.4534	| 9.9757
 bed    	| OOD	| 79	| bed    	| 6.5838	| 3.2678	| 11.7940
 bed    	| OOD	| 55	| desk    	| 5.8657	| 2.5874	| 13.2493
Fail tar: 2/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 1	| desk    	| 19.1245	| 19.1245	| 19.1245
 cabinet    	| ID	| 1	| desk    	| 18.8499	| 18.8499	| 18.8499
OOD J Test - Acc: 0.5253, Th: 4.1284
Fail src: 202/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 68	| desk    	| 3.1477	| 1.9277	| 4.0732
 desk    	| OOD	| 51	| bed    	| 3.2665	| 1.4534	| 4.1011
 toilet    	| OOD	| 27	| desk    	| 3.0451	| 1.7778	| 4.1056
 toilet    	| OOD	| 12	| toilet    	| 2.6597	| 1.6321	| 3.9511
 bed    	| OOD	| 10	| desk    	| 3.4648	| 2.5874	| 3.9050
Fail tar: 1170/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 217	| display    	| 8.1278	| 4.1535	| 10.9914
 cabinet    	| ID	| 172	| display    	| 7.6400	| 4.1702	| 13.1132
 chair    	| ID	| 129	| desk    	| 6.9626	| 4.1728	| 19.1245
 cabinet    	| ID	| 123	| desk    	| 6.6324	| 4.1558	| 18.8499
 shelf    	| ID	| 70	| desk    	| 5.8925	| 4.1535	| 10.6636
SRC->TAR1:      AUROC: 0.6359, FPR95: 0.8677, AUPR_IN: 0.4937, AUPR_OUT: 0.7309, F1_TH: 19.1245, F1_TH_ACC: 0.6138, J_TH: 4.1284, J_TH_ACC: 0.5932
SRC->TAR2:      AUROC: 0.5896, FPR95: 0.8973, AUPR_IN: 0.5608, AUPR_OUT: 0.6038, F1_TH: 18.8499, F1_TH_ACC: 0.5174, J_TH: 5.4059, J_TH_ACC: 0.5651
SRC->TAR1+TAR2: AUROC: 0.6173, FPR95: 0.8796, AUPR_IN: 0.3571, AUPR_OUT: 0.8069, F1_TH: 18.8499, F1_TH_ACC: 0.7266, J_TH: 4.1284, J_TH_ACC: 0.5253
to spreadsheet: 0.6359314012983599,0.8677290836653386,0.49369391124803086,0.7309064693349223,0.5895771279942945,0.89728453364817,0.5608090999229939,0.60381073178952,0.6172529667177018,0.8796384395813511,0.3570705344250133,0.806888660664225
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...

  warnings.warn(_create_warning_msg(



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 718.1976
OOD J Test - Acc: 0.5888, Th: 171.4414
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5168, Th: 710.3706
OOD J Test - Acc: 0.5572, Th: 269.1229
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7263, Th: 710.3706
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 286	| desk    	| 233.8003	| 48.8513	| 661.9459
 display    	| OOD	| 165	| display    	| 265.6309	| 82.1966	| 415.6054
 desk    	| OOD	| 96	| bed    	| 147.9172	| 17.8884	| 410.8001
 bed    	| OOD	| 79	| bed    	| 222.0709	| 107.7624	| 360.2607
 bed    	| OOD	| 55	| desk    	| 223.2965	| 69.8414	| 496.2770
Fail tar: 3/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 1	| desk    	| 804.6891	| 804.6891	| 804.6891
 chair    	| ID	| 1	| desk    	| 718.1976	| 718.1976	| 718.1976
 bag    	| ID	| 1	| desk    	| 710.3706	| 710.3706	| 710.3706
OOD J Test - Acc: 0.5578, Th: 182.8889
Fail src: 310/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 106	| desk    	| 124.7258	| 48.8513	| 181.3458
 desk    	| OOD	| 72	| bed    	| 117.6050	| 17.8884	| 174.0281
 toilet    	| OOD	| 31	| desk    	| 121.3020	| 44.6456	| 175.8229
 bed    	| OOD	| 24	| bed    	| 147.6790	| 107.7624	| 177.5989
 bed    	| OOD	| 22	| desk    	| 132.0314	| 69.8414	| 177.9651
Fail tar: 968/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 211	| display    	| 290.0095	| 188.7094	| 355.9891
 cabinet    	| ID	| 157	| display    	| 279.7498	| 183.2069	| 426.8899
 chair    	| ID	| 105	| desk    	| 289.9553	| 187.5057	| 718.1976
 cabinet    	| ID	| 105	| desk    	| 276.7890	| 184.8061	| 804.6891
 shelf    	| ID	| 58	| desk    	| 247.4168	| 183.7854	| 385.0085
SRC->TAR1:      AUROC: 0.6168, FPR95: 0.8757, AUPR_IN: 0.4850, AUPR_OUT: 0.7182, F1_TH: 718.1976, F1_TH_ACC: 0.6138, J_TH: 171.4414, J_TH_ACC: 0.5888
SRC->TAR2:      AUROC: 0.5597, FPR95: 0.9162, AUPR_IN: 0.5390, AUPR_OUT: 0.5713, F1_TH: 710.3706, F1_TH_ACC: 0.5168, J_TH: 269.1229, J_TH_ACC: 0.5572
SRC->TAR1+TAR2: AUROC: 0.5938, FPR95: 0.8920, AUPR_IN: 0.3445, AUPR_OUT: 0.7929, F1_TH: 710.3706, F1_TH_ACC: 0.7263, J_TH: 182.8889, J_TH_ACC: 0.5578
to spreadsheet: 0.6168412643840879,0.8756972111553785,0.4849980096079314,0.7181967604256232,0.5597165870585344,0.9161747343565525,0.5389831027883197,0.5712693990517891,0.5938229001144668,0.8920076117982874,0.34448308710855996,0.792850158161783
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Estimating react threshold...
t = 2.7790
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=2.7790)...
React - using SR2 test to compute threshold



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.6967, Clf Bal Acc: 0.6155
Src Test - Fail: 239/788
	A desk is predicted as bed - 96 times
	A bed is predicted as desk - 55 times
	A toilet is predicted as desk - 47 times
	A display is predicted as desk - 15 times
	A toilet is predicted as bed - 9 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 16.7219
OOD J Test - Acc: 0.6055, Th: 4.5058
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 14.9766
OOD J Test - Acc: 0.5700, Th: 6.0875
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7266, Th: 14.9766
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 286	| desk    	| 6.3169	| 1.9277	| 14.8948
 display    	| OOD	| 165	| display    	| 7.3529	| 2.1102	| 10.3789
 desk    	| OOD	| 96	| bed    	| 4.4463	| 1.4534	| 9.7615
 bed    	| OOD	| 79	| bed    	| 6.5339	| 3.2679	| 11.3577
 bed    	| OOD	| 55	| desk    	| 5.8084	| 2.5877	| 12.4031
Fail tar: 2/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 1	| desk    	| 16.7219	| 16.7219	| 16.7219
 cabinet    	| ID	| 1	| desk    	| 14.9766	| 14.9766	| 14.9766
OOD J Test - Acc: 0.5166, Th: 4.0236
Fail src: 188/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 64	| desk    	| 3.0904	| 1.9277	| 3.8827
 desk    	| OOD	| 44	| bed    	| 3.1363	| 1.4534	| 3.9475
 toilet    	| OOD	| 26	| desk    	| 3.0040	| 1.7778	| 3.9315
 toilet    	| OOD	| 12	| toilet    	| 2.6597	| 1.6321	| 3.9511
 bed    	| OOD	| 10	| desk    	| 3.4648	| 2.5877	| 3.9051
Fail tar: 1209/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 218	| display    	| 7.4910	| 4.0837	| 9.7243
 cabinet    	| ID	| 173	| display    	| 7.1809	| 4.1096	| 11.2728
 chair    	| ID	| 133	| desk    	| 6.8123	| 4.0769	| 16.7219
 cabinet    	| ID	| 124	| desk    	| 6.5269	| 4.1181	| 14.9766
 shelf    	| ID	| 74	| desk    	| 5.7818	| 4.0445	| 10.5975
SRC->TAR1:      AUROC: 0.6433, FPR95: 0.8677, AUPR_IN: 0.5088, AUPR_OUT: 0.7332, F1_TH: 16.7219, F1_TH_ACC: 0.6138, J_TH: 4.5058, J_TH_ACC: 0.6055
SRC->TAR2:      AUROC: 0.5947, FPR95: 0.8949, AUPR_IN: 0.5781, AUPR_OUT: 0.6056, F1_TH: 14.9766, F1_TH_ACC: 0.5174, J_TH: 6.0875, J_TH_ACC: 0.5700
SRC->TAR1+TAR2: AUROC: 0.6237, FPR95: 0.8787, AUPR_IN: 0.3746, AUPR_OUT: 0.8085, F1_TH: 14.9766, F1_TH_ACC: 0.7266, J_TH: 4.0236, J_TH_ACC: 0.5166
to spreadsheet: 0.6432655166137481,0.8677290836653386,0.5087811692053702,0.7331911515174111,0.5946877303591656,0.8949232585596222,0.5781208321487452,0.6056425859592727,0.6236911184417064,0.878686964795433,0.374603781178575,0.8085426010531911
################################################################################
