Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='/content/3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_CE_SR1_CORRUPTION', eval_step=1, save_step=10, ckpt_path='/content/SemNov_AML_DAAI_23-24/trained_models/DGCNN_CE_SR1_CORRUPTION.pth', src='SR1', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', wandb_api=None, loss='CE', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, open_shape=None, corruption='all', tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_train.h5
ModelNet40_OOD - split: train, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
SR1 train data len: 2378
get_list_corr_data for modelnet_set1 - split train
loading both lidar and occlusion data
corr list files: ['/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev4.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev4.h5']

Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev1.h5 datas: (2378, 768, 3), labels: (2378,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev2.h5 datas: (2378, 768, 3), labels: (2378,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev3.h5 datas: (2377, 768, 3), labels: (2377,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_train_lidar_sev4.h5 datas: (2377, 768, 3), labels: (2377,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev1.h5 datas: (2378, 1024, 3), labels: (2378,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev2.h5 datas: (2378, 1024, 3), labels: (2378,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev3.h5 datas: (2377, 1024, 3), labels: (2377,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_train_occlusion_sev4.h5 datas: (2377, 1024, 3), labels: (2377,)
Cumulative (clean+corrupted) train data len: 21398
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
Src is SR1

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 400, 1: 401, 2: 402, 3: 403, 11: 404}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 5, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8003 M
Load weights:  <All keys matched successfully>



Src logits: torch.Size([1255, 5]), tar1 logits: torch.Size([788, 5]), tar2 logits: torch.Size([847, 5])

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7200, Th: 0.9315
OOD J Test - Acc: 0.7259, Th: 0.9966
Test Tar2
OOD F1 Test - Acc: 0.7407, Th: 0.9571
OOD J Test - Acc: 0.7450, Th: 0.9900
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7408, Th: 0.9890
Fail src: 313/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 77	| door    	| 0.8698	| 0.4588	| 0.9881
 chair    	| OOD	| 38	| chair    	| 0.8901	| 0.5435	| 0.9887
 toilet    	| OOD	| 37	| toilet    	| 0.8525	| 0.5269	| 0.9881
 sofa    	| OOD	| 36	| sofa    	| 0.8696	| 0.5559	| 0.9852
 shelf    	| OOD	| 27	| shelf    	| 0.8949	| 0.6196	| 0.9864
Fail tar: 436/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 74	| sofa    	| 0.9969	| 0.9891	| 0.9999
 display    	| ID	| 55	| chair    	| 0.9983	| 0.9890	| 1.0000
 bag    	| ID	| 47	| chair    	| 0.9984	| 0.9897	| 1.0000
 cabinet    	| ID	| 43	| toilet    	| 0.9975	| 0.9903	| 1.0000
 bin    	| ID	| 42	| chair    	| 0.9971	| 0.9898	| 0.9999
OOD J Test - Acc: 0.7540, Th: 0.9965
Fail src: 422/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 107	| door    	| 0.9044	| 0.4588	| 0.9962
 chair    	| OOD	| 56	| chair    	| 0.9234	| 0.5435	| 0.9964
 toilet    	| OOD	| 53	| toilet    	| 0.8948	| 0.5269	| 0.9961
 sofa    	| OOD	| 45	| sofa    	| 0.8942	| 0.5559	| 0.9963
 shelf    	| OOD	| 36	| shelf    	| 0.9191	| 0.6196	| 0.9958
Fail tar: 289/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 48	| sofa    	| 0.9987	| 0.9965	| 0.9999
 display    	| ID	| 45	| chair    	| 0.9994	| 0.9970	| 1.0000
 bag    	| ID	| 41	| chair    	| 0.9992	| 0.9970	| 1.0000
 cabinet    	| ID	| 32	| toilet    	| 0.9989	| 0.9966	| 1.0000
 bin    	| ID	| 26	| chair    	| 0.9989	| 0.9967	| 0.9999
SRC->TAR1:      AUROC: 0.8046, FPR95: 0.8096, AUPR_IN: 0.8827, AUPR_OUT: 0.6614, F1_TH: 0.9315, F1_TH_ACC: 0.7200, J_TH: 0.9966, J_TH_ACC: 0.7259
SRC->TAR2:      AUROC: 0.8102, FPR95: 0.7792, AUPR_IN: 0.8733, AUPR_OUT: 0.6923, F1_TH: 0.9571, F1_TH_ACC: 0.7407, J_TH: 0.9900, J_TH_ACC: 0.7450
SRC->TAR1+TAR2: AUROC: 0.8075, FPR95: 0.7939, AUPR_IN: 0.7992, AUPR_OUT: 0.8050, F1_TH: 0.9890, F1_TH_ACC: 0.7408, J_TH: 0.9965, J_TH_ACC: 0.7540
to spreadsheet: 0.8045680223269359,0.8096446700507615,0.8826511868893127,0.6614461444274762,0.8102155721858728,0.7792207792207793,0.8732809951487678,0.692332344657701,0.8074936949449908,0.7938837920489297,0.7992492423624925,0.8049690460207698
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7367, Th: 5.7296
OOD J Test - Acc: 0.7362, Th: 7.3619
Test Tar2
OOD F1 Test - Acc: 0.7203, Th: 4.9956
OOD J Test - Acc: 0.7265, Th: 7.3619
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7284, Th: 7.3619
Fail src: 329/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 121	| door    	| 5.6212	| 2.4652	| 7.2956
 chair    	| OOD	| 37	| chair    	| 6.0581	| 3.2867	| 7.2846
 shelf    	| OOD	| 31	| shelf    	| 5.4858	| 3.3739	| 7.2037
 toilet    	| OOD	| 30	| toilet    	| 5.9610	| 3.1510	| 7.2825
 toilet    	| OOD	| 26	| chair    	| 5.9045	| 3.2412	| 7.2748
Fail tar: 456/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 69	| chair    	| 9.1803	| 7.3832	| 13.6101
 table    	| ID	| 59	| sofa    	| 8.5697	| 7.3844	| 12.1754
 desk    	| ID	| 45	| toilet    	| 9.3875	| 7.4153	| 12.6575
 cabinet    	| ID	| 44	| toilet    	| 9.3936	| 7.4051	| 13.0321
 display    	| ID	| 41	| chair    	| 9.1475	| 7.4104	| 12.2203
OOD J Test - Acc: 0.7284, Th: 7.3619
Fail src: 329/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 121	| door    	| 5.6212	| 2.4652	| 7.2956
 chair    	| OOD	| 37	| chair    	| 6.0581	| 3.2867	| 7.2846
 shelf    	| OOD	| 31	| shelf    	| 5.4858	| 3.3739	| 7.2037
 toilet    	| OOD	| 30	| toilet    	| 5.9610	| 3.1510	| 7.2825
 toilet    	| OOD	| 26	| chair    	| 5.9045	| 3.2412	| 7.2748
Fail tar: 456/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 69	| chair    	| 9.1803	| 7.3832	| 13.6101
 table    	| ID	| 59	| sofa    	| 8.5697	| 7.3844	| 12.1754
 desk    	| ID	| 45	| toilet    	| 9.3875	| 7.4153	| 12.6575
 cabinet    	| ID	| 44	| toilet    	| 9.3936	| 7.4051	| 13.0321
 display    	| ID	| 41	| chair    	| 9.1475	| 7.4104	| 12.2203
SRC->TAR1:      AUROC: 0.8132, FPR95: 0.7069, AUPR_IN: 0.8797, AUPR_OUT: 0.7111, F1_TH: 5.7296, F1_TH_ACC: 0.7367, J_TH: 7.3619, J_TH_ACC: 0.7362
SRC->TAR2:      AUROC: 0.8019, FPR95: 0.6836, AUPR_IN: 0.8586, AUPR_OUT: 0.7239, F1_TH: 4.9956, F1_TH_ACC: 0.7203, J_TH: 7.3619, J_TH_ACC: 0.7265
SRC->TAR1+TAR2: AUROC: 0.8073, FPR95: 0.6948, AUPR_IN: 0.7823, AUPR_OUT: 0.8293, F1_TH: 7.3619, F1_TH_ACC: 0.7284, J_TH: 7.3619, J_TH_ACC: 0.7284
to spreadsheet: 0.813160555746557,0.7068527918781726,0.8797391253116228,0.7110796279176977,0.8018542124300907,0.6835891381345927,0.8586200776864665,0.7238908901543374,0.8073033858449993,0.6948012232415902,0.7823130957730748,0.8293204394019147
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7200, Th: 19.8082
OOD J Test - Acc: 0.7259, Th: 199.1149
Test Tar2
OOD F1 Test - Acc: 0.7431, Th: 26.0225
OOD J Test - Acc: 0.7460, Th: 82.6071
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7433, Th: 82.6071
Fail src: 319/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 80	| door    	| 27.3417	| 4.7388	| 78.9492
 chair    	| OOD	| 38	| chair    	| 32.8310	| 7.1598	| 80.2307
 sofa    	| OOD	| 38	| sofa    	| 26.6955	| 5.4599	| 74.9687
 toilet    	| OOD	| 37	| toilet    	| 23.1288	| 6.4681	| 72.5156
 shelf    	| OOD	| 28	| shelf    	| 25.9162	| 6.2970	| 79.8811
Fail tar: 423/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 71	| sofa    	| 785.0494	| 85.1288	| 7986.4590
 display    	| ID	| 53	| chair    	| 4946.3575	| 96.6514	| 92332.6250
 bag    	| ID	| 45	| chair    	| 5006.5150	| 97.8252	| 77417.3984
 cabinet    	| ID	| 43	| toilet    	| 6601.4804	| 85.5913	| 135859.7969
 bin    	| ID	| 42	| chair    	| 946.2221	| 87.0288	| 8236.1787
OOD J Test - Acc: 0.7433, Th: 82.6071
Fail src: 319/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 80	| door    	| 27.3417	| 4.7388	| 78.9492
 chair    	| OOD	| 38	| chair    	| 32.8310	| 7.1598	| 80.2307
 sofa    	| OOD	| 38	| sofa    	| 26.6955	| 5.4599	| 74.9687
 toilet    	| OOD	| 37	| toilet    	| 23.1288	| 6.4681	| 72.5156
 shelf    	| OOD	| 28	| shelf    	| 25.9162	| 6.2970	| 79.8811
Fail tar: 423/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 71	| sofa    	| 785.0494	| 85.1288	| 7986.4590
 display    	| ID	| 53	| chair    	| 4946.3575	| 96.6514	| 92332.6250
 bag    	| ID	| 45	| chair    	| 5006.5150	| 97.8252	| 77417.3984
 cabinet    	| ID	| 43	| toilet    	| 6601.4804	| 85.5913	| 135859.7969
 bin    	| ID	| 42	| chair    	| 946.2221	| 87.0288	| 8236.1787
SRC->TAR1:      AUROC: 0.8068, FPR95: 0.7931, AUPR_IN: 0.8835, AUPR_OUT: 0.6750, F1_TH: 19.8082, F1_TH_ACC: 0.7200, J_TH: 199.1149, J_TH_ACC: 0.7259
SRC->TAR2:      AUROC: 0.8126, FPR95: 0.7568, AUPR_IN: 0.8740, AUPR_OUT: 0.7093, F1_TH: 26.0225, F1_TH_ACC: 0.7431, J_TH: 82.6071, J_TH_ACC: 0.7460
SRC->TAR1+TAR2: AUROC: 0.8098, FPR95: 0.7743, AUPR_IN: 0.8002, AUPR_OUT: 0.8149, F1_TH: 82.6071, F1_TH_ACC: 0.7433, J_TH: 82.6071, J_TH_ACC: 0.7433
to spreadsheet: 0.8068436912249479,0.7931472081218274,0.8835441827738055,0.6749738925995972,0.8126149475298334,0.7567886658795749,0.8739985880525153,0.7092727478360608,0.8098334490783046,0.7743119266055046,0.8002257684765434,0.8148632203502121
################################################################################

################################################################################
Computing OOD metrics with distance from train features...




Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8311, Clf Bal Acc: 0.7939
Src Test - Fail: 212/1255
	A toilet is predicted as chair - 89 times
	A sofa is predicted as toilet - 40 times
	A door is predicted as toilet - 31 times
	A door is predicted as chair - 11 times
	A door is predicted as sofa - 8 times
Test Tar1
OOD F1 Test - Acc: 0.6368, Th: 0.8651
OOD J Test - Acc: 0.6314, Th: 1.3251
Test Tar2
OOD F1 Test - Acc: 0.6489, Th: 0.8642
OOD J Test - Acc: 0.6565, Th: 1.3375
Test Tar1+Tar2
OOD F1 Test - Acc: 0.5886, Th: 1.0354
Fail src: 194/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| OOD	| 69	| shelf    	| 0.8701	| 0.6310	| 1.0291
 chair    	| OOD	| 20	| chair    	| 0.9151	| 0.5978	| 1.0221
 sofa    	| OOD	| 18	| sofa    	| 0.9400	| 0.6394	| 1.0242
 toilet    	| OOD	| 15	| toilet    	| 0.9365	| 0.7434	| 1.0297
 door    	| OOD	| 15	| door    	| 0.9358	| 0.6580	| 1.0348
Fail tar: 995/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 155	| sofa    	| 1.3753	| 1.0369	| 2.3064
 bed    	| ID	| 97	| door    	| 1.4549	| 1.0372	| 3.0356
 cabinet    	| ID	| 68	| toilet    	| 1.4011	| 1.0452	| 2.3394
 display    	| ID	| 67	| chair    	| 1.5628	| 1.0378	| 2.2965
 cabinet    	| ID	| 66	| door    	| 1.3135	| 1.0390	| 2.0345
OOD J Test - Acc: 0.6668, Th: 1.3271
Fail src: 511/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| OOD	| 149	| shelf    	| 1.0350	| 0.6310	| 1.3251
 chair    	| OOD	| 104	| chair    	| 1.1378	| 0.5978	| 1.3204
 door    	| OOD	| 60	| door    	| 1.1368	| 0.6580	| 1.3230
 sofa    	| OOD	| 47	| sofa    	| 1.0839	| 0.6394	| 1.2982
 toilet    	| OOD	| 45	| toilet    	| 1.0844	| 0.7434	| 1.3253
Fail tar: 452/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 73	| sofa    	| 1.6034	| 1.3414	| 2.3064
 bed    	| ID	| 55	| door    	| 1.6711	| 1.3319	| 3.0356
 display    	| ID	| 51	| chair    	| 1.6847	| 1.3415	| 2.2965
 bag    	| ID	| 41	| chair    	| 1.5206	| 1.3308	| 2.0339
 cabinet    	| ID	| 35	| toilet    	| 1.5917	| 1.3358	| 2.3394
SRC->TAR1:      AUROC: 0.6721, FPR95: 0.8655, AUPR_IN: 0.7425, AUPR_OUT: 0.5359, F1_TH: 0.8651, F1_TH_ACC: 0.6368, J_TH: 1.3251, J_TH_ACC: 0.6314
SRC->TAR2:      AUROC: 0.7226, FPR95: 0.7981, AUPR_IN: 0.7874, AUPR_OUT: 0.6047, F1_TH: 0.8642, F1_TH_ACC: 0.6489, J_TH: 1.3375, J_TH_ACC: 0.6565
SRC->TAR1+TAR2: AUROC: 0.6983, FPR95: 0.8306, AUPR_IN: 0.6235, AUPR_OUT: 0.7245, F1_TH: 1.0354, F1_TH_ACC: 0.5886, J_TH: 1.3271, J_TH_ACC: 0.6668
to spreadsheet: 0.6721004307642526,0.8654822335025381,0.742504109416074,0.53590032534384,0.7226353147034061,0.7981109799291618,0.7874181257755531,0.604685395949598,0.6982796642177467,0.8305810397553517,0.6235227307633773,0.7245009836837607

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.3147, Clf Bal Acc: 0.2000
Src Test - Fail: 860/1255
	A door is predicted as chair - 267 times
	A toilet is predicted as chair - 254 times
	A shelf is predicted as chair - 221 times
	A sofa is predicted as chair - 118 times
Test Tar1
OOD F1 Test - Acc: 0.6946, Th: 0.3408
OOD J Test - Acc: 0.7156, Th: 0.4187
Test Tar2
OOD F1 Test - Acc: 0.6532, Th: 0.3411
OOD J Test - Acc: 0.6855, Th: 0.4370
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6958, Th: 0.3972
Fail src: 311/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 113	| chair    	| 0.3523	| 0.2551	| 0.3971
 shelf    	| OOD	| 63	| chair    	| 0.3441	| 0.2657	| 0.3879
 sofa    	| OOD	| 54	| chair    	| 0.3521	| 0.2990	| 0.3944
 toilet    	| OOD	| 44	| chair    	| 0.3646	| 0.3061	| 0.3965
 chair    	| OOD	| 37	| chair    	| 0.3588	| 0.2776	| 0.3955
Fail tar: 568/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 104	| chair    	| 0.4603	| 0.3978	| 0.6499
 cabinet    	| ID	| 93	| chair    	| 0.4842	| 0.3999	| 0.8850
 bin    	| ID	| 70	| chair    	| 0.4482	| 0.3986	| 0.6389
 display    	| ID	| 69	| chair    	| 0.5910	| 0.4031	| 0.9398
 bag    	| ID	| 64	| chair    	| 0.5559	| 0.4020	| 0.8113
OOD J Test - Acc: 0.7093, Th: 0.4190
Fail src: 391/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 143	| chair    	| 0.3638	| 0.2551	| 0.4180
 shelf    	| OOD	| 74	| chair    	| 0.3537	| 0.2657	| 0.4171
 sofa    	| OOD	| 64	| chair    	| 0.3608	| 0.2990	| 0.4173
 toilet    	| OOD	| 60	| chair    	| 0.3761	| 0.3061	| 0.4172
 chair    	| OOD	| 50	| chair    	| 0.3709	| 0.2776	| 0.4187
Fail tar: 449/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 74	| chair    	| 0.5035	| 0.4192	| 0.8850
 table    	| ID	| 71	| chair    	| 0.4845	| 0.4213	| 0.6499
 display    	| ID	| 66	| chair    	| 0.5994	| 0.4227	| 0.9398
 bag    	| ID	| 62	| chair    	| 0.5607	| 0.4237	| 0.8113
 bin    	| ID	| 47	| chair    	| 0.4688	| 0.4251	| 0.6389
SRC->TAR1:      AUROC: 0.7764, FPR95: 0.7424, AUPR_IN: 0.8380, AUPR_OUT: 0.6591, F1_TH: 0.3408, F1_TH_ACC: 0.6946, J_TH: 0.4187, J_TH_ACC: 0.7156
SRC->TAR2:      AUROC: 0.7463, FPR95: 0.8312, AUPR_IN: 0.8139, AUPR_OUT: 0.6163, F1_TH: 0.3411, F1_TH_ACC: 0.6532, J_TH: 0.4370, J_TH_ACC: 0.6855
SRC->TAR1+TAR2: AUROC: 0.7608, FPR95: 0.7884, AUPR_IN: 0.7137, AUPR_OUT: 0.7751, F1_TH: 0.3972, F1_TH_ACC: 0.6958, J_TH: 0.4190, J_TH_ACC: 0.7093
to spreadsheet: 0.7764141403927437,0.7423857868020305,0.8380422479722168,0.6591351674460914,0.7462805213620136,0.8311688311688312,0.8139306636815191,0.6163053986077501,0.7608036356104633,0.7883792048929663,0.7136882547336625,0.775058282979771

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8406, Clf Bal Acc: 0.8102
Src Test - Fail: 200/1255
	A toilet is predicted as chair - 89 times
	A sofa is predicted as toilet - 33 times
	A door is predicted as toilet - 31 times
	A door is predicted as chair - 13 times
	A door is predicted as sofa - 6 times
Test Tar1
OOD F1 Test - Acc: 0.7225, Th: 0.9707
OOD J Test - Acc: 0.7146, Th: 0.9818
Test Tar2
OOD F1 Test - Acc: 0.7331, Th: 0.9706
OOD J Test - Acc: 0.7369, Th: 0.9792
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7211, Th: 0.9792
Fail src: 307/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 80	| door    	| 0.9615	| 0.8760	| 0.9788
 chair    	| OOD	| 59	| chair    	| 0.9652	| 0.8759	| 0.9779
 toilet    	| OOD	| 40	| chair    	| 0.9636	| 0.9305	| 0.9790
 toilet    	| OOD	| 36	| toilet    	| 0.9645	| 0.9227	| 0.9788
 sofa    	| OOD	| 25	| sofa    	| 0.9605	| 0.8398	| 0.9781
Fail tar: 499/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 56	| toilet    	| 0.9892	| 0.9797	| 0.9982
 table    	| ID	| 55	| sofa    	| 0.9859	| 0.9794	| 0.9940
 display    	| ID	| 46	| chair    	| 0.9882	| 0.9801	| 0.9951
 bed    	| ID	| 44	| door    	| 0.9875	| 0.9795	| 0.9970
 desk    	| ID	| 41	| toilet    	| 0.9880	| 0.9805	| 0.9942
OOD J Test - Acc: 0.7225, Th: 0.9798
Fail src: 319/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 80	| door    	| 0.9615	| 0.8760	| 0.9788
 chair    	| OOD	| 67	| chair    	| 0.9669	| 0.8759	| 0.9795
 toilet    	| OOD	| 40	| chair    	| 0.9636	| 0.9305	| 0.9790
 toilet    	| OOD	| 36	| toilet    	| 0.9645	| 0.9227	| 0.9788
 sofa    	| OOD	| 26	| sofa    	| 0.9612	| 0.8398	| 0.9792
Fail tar: 483/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 cabinet    	| ID	| 55	| toilet    	| 0.9894	| 0.9799	| 0.9982
 table    	| ID	| 52	| sofa    	| 0.9863	| 0.9802	| 0.9940
 display    	| ID	| 46	| chair    	| 0.9882	| 0.9801	| 0.9951
 bed    	| ID	| 43	| door    	| 0.9877	| 0.9799	| 0.9970
 desk    	| ID	| 41	| toilet    	| 0.9880	| 0.9805	| 0.9942
SRC->TAR1:      AUROC: 0.7893, FPR95: 0.7373, AUPR_IN: 0.8618, AUPR_OUT: 0.6676, F1_TH: 0.9707, F1_TH_ACC: 0.7225, J_TH: 0.9818, J_TH_ACC: 0.7146
SRC->TAR2:      AUROC: 0.7999, FPR95: 0.7403, AUPR_IN: 0.8489, AUPR_OUT: 0.7058, F1_TH: 0.9706, F1_TH_ACC: 0.7331, J_TH: 0.9792, J_TH_ACC: 0.7369
SRC->TAR1+TAR2: AUROC: 0.7948, FPR95: 0.7388, AUPR_IN: 0.7591, AUPR_OUT: 0.8105, F1_TH: 0.9792, F1_TH_ACC: 0.7211, J_TH: 0.9798, J_TH_ACC: 0.7225
to spreadsheet: 0.7892854976034948,0.7373096446700508,0.8618006592715692,0.6676477355607684,0.7999016919335644,0.7402597402597403,0.8488861605246965,0.7058439893985902,0.794785140782436,0.7388379204892966,0.7590853423001815,0.810511031492445

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.3147, Clf Bal Acc: 0.2000
Src Test - Fail: 860/1255
	A door is predicted as chair - 267 times
	A toilet is predicted as chair - 254 times
	A shelf is predicted as chair - 221 times
	A sofa is predicted as chair - 118 times
Test Tar1
OOD F1 Test - Acc: 0.6867, Th: 0.8089
OOD J Test - Acc: 0.6750, Th: 0.8902
Test Tar2
OOD F1 Test - Acc: 0.7084, Th: 0.8142
OOD J Test - Acc: 0.6979, Th: 0.8875
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6471, Th: 0.8309
Fail src: 202/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 89	| chair    	| 0.7769	| 0.6299	| 0.8306
 chair    	| OOD	| 52	| chair    	| 0.7816	| 0.6689	| 0.8298
 toilet    	| OOD	| 43	| chair    	| 0.7851	| 0.6671	| 0.8293
 sofa    	| OOD	| 18	| chair    	| 0.7664	| 0.6878	| 0.8257
Fail tar: 818/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 205	| chair    	| 0.8914	| 0.8312	| 0.9775
 cabinet    	| ID	| 155	| chair    	| 0.8999	| 0.8309	| 0.9855
 desk    	| ID	| 97	| chair    	| 0.8886	| 0.8333	| 0.9807
 sink    	| ID	| 69	| chair    	| 0.9029	| 0.8322	| 0.9882
 display    	| ID	| 62	| chair    	| 0.9124	| 0.8357	| 0.9641
OOD J Test - Acc: 0.7042, Th: 0.8905
Fail src: 451/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 166	| chair    	| 0.8160	| 0.6299	| 0.8903
 chair    	| OOD	| 135	| chair    	| 0.8308	| 0.6689	| 0.8902
 toilet    	| OOD	| 87	| chair    	| 0.8238	| 0.6671	| 0.8899
 sofa    	| OOD	| 58	| chair    	| 0.8302	| 0.6878	| 0.8884
 shelf    	| OOD	| 5	| chair    	| 0.8693	| 0.8461	| 0.8879
Fail tar: 404/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 100	| chair    	| 0.9232	| 0.8907	| 0.9775
 cabinet    	| ID	| 89	| chair    	| 0.9296	| 0.8911	| 0.9855
 display    	| ID	| 46	| chair    	| 0.9286	| 0.8937	| 0.9641
 desk    	| ID	| 41	| chair    	| 0.9204	| 0.8934	| 0.9807
 sink    	| ID	| 38	| chair    	| 0.9379	| 0.8913	| 0.9882
SRC->TAR1:      AUROC: 0.7471, FPR95: 0.8211, AUPR_IN: 0.8373, AUPR_OUT: 0.6128, F1_TH: 0.8089, F1_TH_ACC: 0.6867, J_TH: 0.8902, J_TH_ACC: 0.6750
SRC->TAR2:      AUROC: 0.7724, FPR95: 0.7910, AUPR_IN: 0.8273, AUPR_OUT: 0.6700, F1_TH: 0.8142, F1_TH_ACC: 0.7084, J_TH: 0.8875, J_TH_ACC: 0.6979
SRC->TAR1+TAR2: AUROC: 0.7602, FPR95: 0.8055, AUPR_IN: 0.7256, AUPR_OUT: 0.7784, F1_TH: 0.8309, F1_TH_ACC: 0.6471, J_TH: 0.8905, J_TH_ACC: 0.7042
to spreadsheet: 0.7471302606831557,0.8210659898477157,0.8373414815377251,0.6128282731630764,0.7724412856249148,0.7910271546635183,0.8272829859346409,0.6700199661982174,0.760242455255431,0.8055045871559633,0.725583686513694,0.7784495785906913
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7342, Th: 0.2011
OOD J Test - Acc: 0.7357, Th: 0.2015
Test Tar2
OOD F1 Test - Acc: 0.7203, Th: 0.2010
OOD J Test - Acc: 0.7265, Th: 0.2015
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7280, Th: 0.2015
Fail src: 329/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 121	| door    	| 0.2011	| 0.2005	| 0.2015
 chair    	| OOD	| 37	| chair    	| 0.2012	| 0.2007	| 0.2015
 shelf    	| OOD	| 31	| shelf    	| 0.2011	| 0.2007	| 0.2014
 toilet    	| OOD	| 30	| toilet    	| 0.2012	| 0.2006	| 0.2015
 toilet    	| OOD	| 26	| chair    	| 0.2012	| 0.2006	| 0.2015
Fail tar: 457/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 69	| chair    	| 0.2018	| 0.2015	| 0.2027
 table    	| ID	| 60	| sofa    	| 0.2017	| 0.2015	| 0.2024
 desk    	| ID	| 45	| toilet    	| 0.2019	| 0.2015	| 0.2025
 cabinet    	| ID	| 44	| toilet    	| 0.2019	| 0.2015	| 0.2026
 display    	| ID	| 41	| chair    	| 0.2018	| 0.2015	| 0.2025
OOD J Test - Acc: 0.7280, Th: 0.2015
Fail src: 329/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 121	| door    	| 0.2011	| 0.2005	| 0.2015
 chair    	| OOD	| 37	| chair    	| 0.2012	| 0.2007	| 0.2015
 shelf    	| OOD	| 31	| shelf    	| 0.2011	| 0.2007	| 0.2014
 toilet    	| OOD	| 30	| toilet    	| 0.2012	| 0.2006	| 0.2015
 toilet    	| OOD	| 26	| chair    	| 0.2012	| 0.2006	| 0.2015
Fail tar: 457/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 69	| chair    	| 0.2018	| 0.2015	| 0.2027
 table    	| ID	| 60	| sofa    	| 0.2017	| 0.2015	| 0.2024
 desk    	| ID	| 45	| toilet    	| 0.2019	| 0.2015	| 0.2025
 cabinet    	| ID	| 44	| toilet    	| 0.2019	| 0.2015	| 0.2026
 display    	| ID	| 41	| chair    	| 0.2018	| 0.2015	| 0.2025
SRC->TAR1:      AUROC: 0.8132, FPR95: 0.7069, AUPR_IN: 0.8798, AUPR_OUT: 0.7109, F1_TH: 0.2011, F1_TH_ACC: 0.7342, J_TH: 0.2015, J_TH_ACC: 0.7357
SRC->TAR2:      AUROC: 0.8020, FPR95: 0.6824, AUPR_IN: 0.8587, AUPR_OUT: 0.7240, F1_TH: 0.2010, F1_TH_ACC: 0.7203, J_TH: 0.2015, J_TH_ACC: 0.7265
SRC->TAR1+TAR2: AUROC: 0.8074, FPR95: 0.6942, AUPR_IN: 0.7825, AUPR_OUT: 0.8293, F1_TH: 0.2015, F1_TH_ACC: 0.7280, J_TH: 0.2015, J_TH_ACC: 0.7280
to spreadsheet: 0.8131681396242442,0.7068527918781726,0.8798081296252138,0.7109082414253867,0.8019647502081404,0.6824085005903188,0.8587284189670146,0.7239838773678171,0.8073643042508865,0.6941896024464832,0.7824667788211572,0.8293120271476577
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7342, Th: 5.7460
OOD J Test - Acc: 0.7372, Th: 7.3647
Test Tar2
OOD F1 Test - Acc: 0.7222, Th: 5.3139
OOD J Test - Acc: 0.7165, Th: 7.6714
Test Tar1+Tar2
OOD F1 Test - Acc: 0.7201, Th: 7.2017
Fail src: 305/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 114	| door    	| 5.6279	| 2.7747	| 7.1787
 shelf    	| OOD	| 30	| shelf    	| 5.5333	| 3.7747	| 7.0524
 chair    	| OOD	| 29	| chair    	| 5.8222	| 3.4316	| 7.1702
 toilet    	| OOD	| 25	| toilet    	| 5.9144	| 3.6400	| 6.9208
 toilet    	| OOD	| 24	| chair    	| 5.9076	| 3.7046	| 7.0432
Fail tar: 504/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 76	| chair    	| 9.0637	| 7.2194	| 13.6103
 table    	| ID	| 66	| sofa    	| 8.4547	| 7.2181	| 12.1756
 desk    	| ID	| 45	| toilet    	| 9.4426	| 7.4306	| 12.6575
 cabinet    	| ID	| 45	| toilet    	| 9.3573	| 7.3531	| 13.0215
 display    	| ID	| 44	| chair    	| 9.0337	| 7.3041	| 12.2203
OOD J Test - Acc: 0.7246, Th: 7.3647
Fail src: 324/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 121	| door    	| 5.7211	| 2.7747	| 7.2962
 chair    	| OOD	| 33	| chair    	| 5.9994	| 3.4316	| 7.3267
 shelf    	| OOD	| 31	| shelf    	| 5.5872	| 3.7747	| 7.2042
 toilet    	| OOD	| 29	| toilet    	| 6.1005	| 3.6400	| 7.3033
 toilet    	| OOD	| 26	| chair    	| 6.0120	| 3.7046	| 7.2791
Fail tar: 472/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 71	| chair    	| 9.1884	| 7.3729	| 13.6103
 table    	| ID	| 59	| sofa    	| 8.5948	| 7.3869	| 12.1756
 desk    	| ID	| 45	| toilet    	| 9.4426	| 7.4306	| 12.6575
 cabinet    	| ID	| 44	| toilet    	| 9.4029	| 7.5176	| 13.0215
 display    	| ID	| 42	| chair    	| 9.1148	| 7.4828	| 12.2203
SRC->TAR1:      AUROC: 0.8131, FPR95: 0.6929, AUPR_IN: 0.8794, AUPR_OUT: 0.7129, F1_TH: 5.7460, F1_TH_ACC: 0.7342, J_TH: 7.3647, J_TH_ACC: 0.7372
SRC->TAR2:      AUROC: 0.8003, FPR95: 0.6789, AUPR_IN: 0.8574, AUPR_OUT: 0.7223, F1_TH: 5.3139, F1_TH_ACC: 0.7222, J_TH: 7.6714, J_TH_ACC: 0.7165
SRC->TAR1+TAR2: AUROC: 0.8064, FPR95: 0.6856, AUPR_IN: 0.7811, AUPR_OUT: 0.8292, F1_TH: 7.2017, F1_TH_ACC: 0.7201, J_TH: 7.3647, J_TH_ACC: 0.7246
to spreadsheet: 0.813091795255526,0.6928934010152284,0.8794204189085867,0.7128859704512979,0.8002521202086575,0.6788665879574971,0.8574286364854345,0.7223358779611053,0.8064402938703901,0.6856269113149847,0.7811186674692027,0.8292389670013818
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7205, Th: 235.4520
OOD J Test - Acc: 0.6960, Th: 332.4233
Test Tar2
OOD F1 Test - Acc: 0.7136, Th: 235.7948
OOD J Test - Acc: 0.6927, Th: 332.9650
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6696, Th: 271.0124
Fail src: 195/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 87	| door    	| 223.6474	| 133.9530	| 270.6625
 shelf    	| OOD	| 19	| shelf    	| 219.2138	| 179.3450	| 264.0124
 toilet    	| OOD	| 18	| toilet    	| 236.4755	| 175.6509	| 269.3478
 door    	| OOD	| 13	| toilet    	| 219.0490	| 146.2748	| 261.9664
 sofa    	| OOD	| 12	| sofa    	| 225.5275	| 129.0912	| 262.9284
Fail tar: 760/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 122	| sofa    	| 338.9488	| 272.0744	| 566.5447
 bin    	| ID	| 103	| chair    	| 386.3481	| 271.3135	| 604.1957
 display    	| ID	| 62	| chair    	| 345.4672	| 273.1065	| 494.2993
 desk    	| ID	| 56	| toilet    	| 373.4167	| 278.1414	| 539.8227
 bag    	| ID	| 53	| chair    	| 351.3256	| 273.2117	| 491.3891
OOD J Test - Acc: 0.7121, Th: 332.7311
Fail src: 436/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 165	| door    	| 258.9856	| 133.9530	| 328.5030
 toilet    	| OOD	| 64	| toilet    	| 284.0949	| 175.6509	| 332.1937
 shelf    	| OOD	| 41	| shelf    	| 263.5611	| 179.3450	| 332.4233
 chair    	| OOD	| 36	| chair    	| 287.2894	| 179.8953	| 330.1863
 toilet    	| OOD	| 34	| chair    	| 283.9992	| 152.3222	| 329.1490
Fail tar: 396/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 78	| chair    	| 413.2914	| 335.0484	| 604.1957
 table    	| ID	| 55	| sofa    	| 379.8486	| 334.3335	| 566.5447
 desk    	| ID	| 39	| toilet    	| 403.4995	| 335.9820	| 539.8227
 display    	| ID	| 37	| chair    	| 378.1473	| 335.8890	| 494.2993
 bag    	| ID	| 32	| chair    	| 380.9445	| 333.8999	| 491.3891
SRC->TAR1:      AUROC: 0.7866, FPR95: 0.7157, AUPR_IN: 0.8518, AUPR_OUT: 0.6883, F1_TH: 235.4520, F1_TH_ACC: 0.7205, J_TH: 332.4233, J_TH_ACC: 0.6960
SRC->TAR2:      AUROC: 0.7788, FPR95: 0.6777, AUPR_IN: 0.8315, AUPR_OUT: 0.7054, F1_TH: 235.7948, F1_TH_ACC: 0.7136, J_TH: 332.9650, J_TH_ACC: 0.6927
SRC->TAR1+TAR2: AUROC: 0.7826, FPR95: 0.6960, AUPR_IN: 0.7372, AUPR_OUT: 0.8140, F1_TH: 271.0124, F1_TH_ACC: 0.6696, J_TH: 332.7311, J_TH_ACC: 0.7121
to spreadsheet: 0.7866008049022184,0.7157360406091371,0.8518068306146909,0.6883285086464666,0.7788162579904703,0.6776859504132231,0.83147705789326,0.7054271234293183,0.7825680763185789,0.6960244648318042,0.7371916026072254,0.8139540797417625
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR1_test.h5
ModelNet40_OOD - split: test, categories: {'chair': 0, 'bookshelf': 1, 'door': 2, 'sink': 3, 'sofa': 4}
React Val - SR1 data len: 340
React Val - adding corrupted synthetic data: all
get_list_corr_data for modelnet_set1 - split test
loading both lidar and occlusion data
corr list files: ['/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev4.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev1.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev2.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev3.h5', '/content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev4.h5']

Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev1.h5 datas: (340, 768, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev2.h5 datas: (340, 768, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev3.h5 datas: (340, 768, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/lidar/modelnet_set1_test_lidar_sev4.h5 datas: (340, 768, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev1.h5 datas: (340, 1024, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev2.h5 datas: (340, 1024, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev3.h5 datas: (340, 1024, 3), labels: (340,)
Reading data from hdf5 file: /content/3D_OS_release_data/ModelNet40_corrupted/occlusion/modelnet_set1_test_occlusion_sev4.h5 datas: (340, 1024, 3), labels: (340,)
React Val - cumulative (clean+corrupted) data len: 3060

Estimating react threshold...
t = 0.3246
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=0.3246)...
React - using SR1 test to compute threshold



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.8390, Clf Bal Acc: 0.8080
Src Test - Fail: 202/1255
	A toilet is predicted as chair - 83 times
	A door is predicted as toilet - 37 times
	A sofa is predicted as toilet - 34 times
	A door is predicted as chair - 12 times
	A door is predicted as sofa - 10 times
Test Tar1
OOD F1 Test - Acc: 0.7293, Th: 5.4987
OOD J Test - Acc: 0.7298, Th: 7.2801
Test Tar2
OOD F1 Test - Acc: 0.7231, Th: 5.2938
OOD J Test - Acc: 0.7136, Th: 7.4419
Test Tar1+Tar2
OOD F1 Test - Acc: 0.6945, Th: 6.4132
Fail src: 225/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 82	| door    	| 5.1540	| 2.7747	| 6.3401
 shelf    	| OOD	| 25	| shelf    	| 5.0443	| 3.7747	| 6.1961
 chair    	| OOD	| 21	| chair    	| 5.4062	| 3.4316	| 6.3408
 sofa    	| OOD	| 18	| sofa    	| 5.2654	| 2.7398	| 6.3628
 toilet    	| OOD	| 16	| chair    	| 5.5206	| 3.7046	| 6.3523
Fail tar: 658/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 table    	| ID	| 93	| sofa    	| 7.9050	| 6.4402	| 10.8958
 bin    	| ID	| 83	| chair    	| 8.5497	| 6.5636	| 12.1311
 desk    	| ID	| 56	| toilet    	| 8.7354	| 6.6717	| 12.4195
 display    	| ID	| 56	| chair    	| 8.5212	| 6.4435	| 12.0152
 cabinet    	| ID	| 54	| toilet    	| 8.4702	| 6.4507	| 12.4157
OOD J Test - Acc: 0.7211, Th: 7.3647
Fail src: 348/1255
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| OOD	| 123	| door    	| 5.7188	| 2.7747	| 7.2962
 shelf    	| OOD	| 47	| shelf    	| 5.9518	| 3.7747	| 7.3518
 chair    	| OOD	| 34	| chair    	| 6.0035	| 3.4316	| 7.3209
 toilet    	| OOD	| 29	| toilet    	| 6.0972	| 3.6400	| 7.3033
 toilet    	| OOD	| 26	| chair    	| 6.0095	| 3.7046	| 7.2516
Fail tar: 458/1635
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bin    	| ID	| 69	| chair    	| 8.8487	| 7.3659	| 12.1311
 table    	| ID	| 58	| sofa    	| 8.5142	| 7.3869	| 10.8958
 desk    	| ID	| 45	| toilet    	| 9.1678	| 7.4306	| 12.4195
 display    	| ID	| 42	| chair    	| 9.0918	| 7.4827	| 12.0152
 cabinet    	| ID	| 42	| toilet    	| 8.9603	| 7.4179	| 12.4157
SRC->TAR1:      AUROC: 0.8048, FPR95: 0.6954, AUPR_IN: 0.8718, AUPR_OUT: 0.7069, F1_TH: 5.4987, F1_TH_ACC: 0.7293, J_TH: 7.2801, J_TH_ACC: 0.7298
SRC->TAR2:      AUROC: 0.7962, FPR95: 0.6789, AUPR_IN: 0.8535, AUPR_OUT: 0.7196, F1_TH: 5.2938, F1_TH_ACC: 0.7231, J_TH: 7.4419, J_TH_ACC: 0.7136
SRC->TAR1+TAR2: AUROC: 0.8003, FPR95: 0.6869, AUPR_IN: 0.7720, AUPR_OUT: 0.8259, F1_TH: 6.4132, F1_TH_ACC: 0.6945, J_TH: 7.3647, J_TH_ACC: 0.7211
to spreadsheet: 0.8048142455558478,0.6954314720812182,0.8718255140909212,0.7068895355519071,0.7961777447471037,0.6788665879574971,0.8534731863165983,0.7196232952560632,0.8003401683784739,0.6868501529051988,0.7720145223983729,0.8259403340473335
################################################################################
