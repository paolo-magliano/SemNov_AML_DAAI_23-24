Cannot import torchlars
Cannot load RSCNN: No module named 'pointnet2_ops'
Cannot load PCT: No module named 'pointnet2_ops'
Cannot load PointMLP: No module named 'pointnet2_ops'
Cannot load PointNet2: No module named 'pointnet2_ops'
/content/SemNov_AML_DAAI_23-24/utils/rsmix_provider.py:157: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if len(label_batch.shape) is 1:
out-of-distribution eval - Modelnet -> SONN ..
Arguments: Namespace(local_rank=None, use_sync_bn=False, use_amp=False, script_mode='eval', config='cfgs/dgcnn-cla.yaml', seed=1, epochs=250, batch_size=1, num_workers=4, resume=None, apply_fix_cellphone=True, data_root='/content/3D_OS_release_data', checkpoints_dir='outputs', exp_name='DGCNN_SUBCENTER_SR2', eval_step=1, save_step=10, ckpt_path='/content/SemNov_AML_DAAI_23-24/trained_models/DGCNN_SUBCENTER_SR2.pth', src='SR2', sonn_split='main_split', sonn_h5_name='objectdataset.h5', augm_set='rw', grad_norm_clip=-1, num_points=1024, num_points_test=2048, wandb_name=None, wandb_group='md-2-sonn-augmCorr', wandb_proj='benchmark-3d-ood-cla', wandb_api=None, loss='subcenter_arcface', cs=False, cs_gan_lr=0.0002, cs_beta=0.1, save_feats=None, open_shape=None, corruption=None, tar1='none', tar2='none')
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_train.h5
ModelNet40_OOD - split: train, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
SR2 train data len: 1916
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Src is SR2

ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {10: 0, 14: 1, 5: 2, 6: 3, 9: 2}, num samples: 788
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {4: 0, 8: 1, 7: 2, 12: 3, 13: 4}, num samples: 1255
ScanObject - num_points: 2048, sonn_split: main_split, h5_suffix: objectdataset.h5, split: all, class_choice: {0: 400, 1: 401, 2: 402, 3: 403, 11: 404}, num samples: 847
dgcnn k: 20
dgcnn emb_dims: 1024
Clf - feature encoder: DGCNN
Clf Head - num classes: 4, input dim: 2048, act: leakyrelu, dropout: 0.5
Model params count: 1.8019 M
Load weights:  <All keys matched successfully>



Src logits: torch.Size([788, 4]), tar1 logits: torch.Size([1255, 4]), tar2 logits: torch.Size([847, 4])
Src: ['bed', 'toilet', 'desk', 'display', 'table']
Tar1: ['chair', 'shelf', 'door', 'sink', 'sofa']
Tar2: ['bag', 'bin', 'box', 'cabinet', 'pillow']

################################################################################
Computing OOD metrics with MSP normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6133, Th: 0.4533
OOD J Test - Acc: 0.4728, Th: 0.3643
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5162, Th: 0.4536
OOD J Test - Acc: 0.6391, Th: 0.3646
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7256, Th: 0.4533
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 0.3879	| 0.2914	| 0.4265
 display    	| OOD	| 171	| display    	| 0.4032	| 0.2943	| 0.4527
 desk    	| OOD	| 101	| bed    	| 0.3912	| 0.3058	| 0.4427
 bed    	| OOD	| 91	| bed    	| 0.4150	| 0.3480	| 0.4399
 bed    	| OOD	| 44	| desk    	| 0.3791	| 0.3313	| 0.4139
Fail tar: 5/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 box    	| ID	| 2	| display    	| 0.4544	| 0.4536	| 0.4552
 bag    	| ID	| 1	| display    	| 0.4580	| 0.4580	| 0.4580
 chair    	| ID	| 1	| display    	| 0.4577	| 0.4577	| 0.4577
 shelf    	| ID	| 1	| display    	| 0.4533	| 0.4533	| 0.4533
OOD J Test - Acc: 0.4723, Th: 0.3646
Fail src: 142/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 34	| desk    	| 0.3456	| 0.2914	| 0.3628
 display    	| OOD	| 26	| display    	| 0.3352	| 0.2943	| 0.3643
 desk    	| OOD	| 23	| bed    	| 0.3442	| 0.3058	| 0.3633
 toilet    	| OOD	| 19	| desk    	| 0.3379	| 0.2920	| 0.3620
 bed    	| OOD	| 9	| desk    	| 0.3451	| 0.3313	| 0.3581
Fail tar: 1383/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 210	| display    	| 0.4165	| 0.3648	| 0.4485
 chair    	| ID	| 185	| desk    	| 0.3972	| 0.3651	| 0.4314
 sofa    	| ID	| 144	| bed    	| 0.4110	| 0.3665	| 0.4404
 cabinet    	| ID	| 135	| display    	| 0.4130	| 0.3647	| 0.4526
 shelf    	| ID	| 89	| desk    	| 0.3899	| 0.3656	| 0.4190
SRC->TAR1:      AUROC: 0.5186, FPR95: 0.8861, AUPR_IN: 0.4072, AUPR_OUT: 0.6517, F1_TH: 0.4533, F1_TH_ACC: 0.6133, J_TH: 0.3643, J_TH_ACC: 0.4728
SRC->TAR2:      AUROC: 0.6573, FPR95: 0.7710, AUPR_IN: 0.5735, AUPR_OUT: 0.6913, F1_TH: 0.4536, F1_TH_ACC: 0.5162, J_TH: 0.3646, J_TH_ACC: 0.6391
SRC->TAR1+TAR2: AUROC: 0.5745, FPR95: 0.8397, AUPR_IN: 0.3098, AUPR_OUT: 0.7946, F1_TH: 0.4533, F1_TH_ACC: 0.7256, J_TH: 0.3646, J_TH_ACC: 0.4723
to spreadsheet: 0.5185511760066334,0.8860557768924303,0.4071737225791106,0.6517324145321312,0.6573259458584794,0.7709563164108618,0.5735070489460355,0.6912871484351385,0.5744704101001222,0.8396764985727878,0.3098064023375019,0.7945969169039253
################################################################################

################################################################################
Computing OOD metrics with MLS normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 0.9993
OOD J Test - Acc: 0.5394, Th: 0.9153
Test Tar2
OOD F1 Test - Acc: 0.6037, Th: 0.8019
OOD J Test - Acc: 0.6691, Th: 0.9248
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7270, Th: 0.9993
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 0.9529	| 0.7358	| 0.9981
 display    	| OOD	| 171	| display    	| 0.9329	| 0.5589	| 0.9991
 desk    	| OOD	| 101	| bed    	| 0.9144	| 0.6258	| 0.9968
 bed    	| OOD	| 91	| bed    	| 0.8827	| 0.6828	| 0.9931
 bed    	| OOD	| 44	| desk    	| 0.9541	| 0.8931	| 0.9968
Fail tar: 1/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 1	| display    	| 0.9993	| 0.9993	| 0.9993
OOD J Test - Acc: 0.5588, Th: 0.9153
Fail src: 216/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 bed    	| OOD	| 55	| bed    	| 0.8325	| 0.6828	| 0.9091
 display    	| OOD	| 41	| display    	| 0.8213	| 0.5589	| 0.9126
 desk    	| OOD	| 40	| bed    	| 0.8411	| 0.6258	| 0.9096
 desk    	| OOD	| 19	| desk    	| 0.8608	| 0.7358	| 0.9139
 toilet    	| OOD	| 19	| desk    	| 0.8254	| 0.4223	| 0.9150
Fail tar: 1059/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 207	| display    	| 0.9682	| 0.9204	| 0.9993
 chair    	| ID	| 190	| desk    	| 0.9594	| 0.9155	| 0.9979
 cabinet    	| ID	| 112	| display    	| 0.9664	| 0.9168	| 0.9989
 shelf    	| ID	| 80	| desk    	| 0.9554	| 0.9154	| 0.9924
 sofa    	| ID	| 66	| bed    	| 0.9572	| 0.9181	| 0.9952
SRC->TAR1:      AUROC: 0.5917, FPR95: 0.8486, AUPR_IN: 0.4668, AUPR_OUT: 0.7089, F1_TH: 0.9993, F1_TH_ACC: 0.6138, J_TH: 0.9153, J_TH_ACC: 0.5394
SRC->TAR2:      AUROC: 0.6995, FPR95: 0.7497, AUPR_IN: 0.6330, AUPR_OUT: 0.7211, F1_TH: 0.8019, F1_TH_ACC: 0.6037, J_TH: 0.9248, J_TH_ACC: 0.6691
SRC->TAR1+TAR2: AUROC: 0.6351, FPR95: 0.8088, AUPR_IN: 0.3675, AUPR_OUT: 0.8263, F1_TH: 0.9993, F1_TH_ACC: 0.7270, J_TH: 0.9153, J_TH_ACC: 0.5588
to spreadsheet: 0.5916870588711145,0.848605577689243,0.4668001186343079,0.7089334698205758,0.6994708106844703,0.7497048406139315,0.6329692315922133,0.7210985718381586,0.6351184755152212,0.8087535680304472,0.3675116424025892,0.8263343223707583
################################################################################

################################################################################
Computing OOD metrics with entropy normality score...
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6118, Th: 3.1249
OOD J Test - Acc: 0.4723, Th: 2.9780
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5174, Th: 3.1250
OOD J Test - Acc: 0.6661, Th: 2.9858
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7253, Th: 3.1249
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 3.0099	| 2.9271	| 3.0822
 display    	| OOD	| 171	| display    	| 3.0249	| 2.9238	| 3.1108
 desk    	| OOD	| 101	| bed    	| 3.0503	| 2.9378	| 3.1235
 bed    	| OOD	| 91	| bed    	| 3.0623	| 2.9944	| 3.1107
 bed    	| OOD	| 44	| desk    	| 3.0051	| 2.9450	| 3.0541
Fail tar: 6/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 sofa    	| ID	| 3	| bed    	| 3.1262	| 3.1249	| 3.1278
 chair    	| ID	| 1	| bed    	| 3.1289	| 3.1289	| 3.1289
 chair    	| ID	| 1	| display    	| 3.1260	| 3.1260	| 3.1260
 bag    	| ID	| 1	| display    	| 3.1250	| 3.1250	| 3.1250
OOD J Test - Acc: 0.4796, Th: 2.9780
Fail src: 124/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 display    	| OOD	| 34	| display    	| 2.9560	| 2.9238	| 2.9771
 desk    	| OOD	| 29	| desk    	| 2.9544	| 2.9271	| 2.9774
 toilet    	| OOD	| 17	| desk    	| 2.9441	| 2.9177	| 2.9690
 desk    	| OOD	| 11	| bed    	| 2.9607	| 2.9378	| 2.9763
 toilet    	| OOD	| 10	| toilet    	| 2.9479	| 2.9178	| 2.9720
Fail tar: 1380/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 209	| display    	| 3.0424	| 2.9810	| 3.1044
 chair    	| ID	| 187	| desk    	| 3.0311	| 2.9781	| 3.1032
 sofa    	| ID	| 148	| bed    	| 3.0596	| 2.9810	| 3.1278
 cabinet    	| ID	| 123	| display    	| 3.0436	| 2.9796	| 3.1129
 shelf    	| ID	| 80	| desk    	| 3.0102	| 2.9781	| 3.0732
SRC->TAR1:      AUROC: 0.5131, FPR95: 0.9131, AUPR_IN: 0.3873, AUPR_OUT: 0.6532, F1_TH: 3.1249, F1_TH_ACC: 0.6118, J_TH: 2.9780, J_TH_ACC: 0.4723
SRC->TAR2:      AUROC: 0.6893, FPR95: 0.8135, AUPR_IN: 0.6140, AUPR_OUT: 0.7169, F1_TH: 3.1250, F1_TH_ACC: 0.5174, J_TH: 2.9858, J_TH_ACC: 0.6661
SRC->TAR1+TAR2: AUROC: 0.5841, FPR95: 0.8730, AUPR_IN: 0.3113, AUPR_OUT: 0.8022, F1_TH: 3.1249, F1_TH_ACC: 0.7253, J_TH: 2.9780, J_TH_ACC: 0.4796
to spreadsheet: 0.5130508423160152,0.9131474103585657,0.38728724303031614,0.6532414645630251,0.6892982997620747,0.8134592680047226,0.6140366364773724,0.7169206035750728,0.5840696798311494,0.8729781160799239,0.3112547901511861,0.8021694849347755
################################################################################

################################################################################
Computing OOD metrics with distance from train features...

  warnings.warn(_create_warning_msg(




Euclidean distances in a non-normalized space:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7310, Clf Bal Acc: 0.6706
Src Test - Fail: 212/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 39 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 11 times
	A display is predicted as desk - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 0.5609
OOD J Test - Acc: 0.6388, Th: 0.1194
Test Tar2
OOD F1 Test - Acc: 0.6110, Th: 0.0608
OOD J Test - Acc: 0.6789, Th: 0.0969
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7270, Th: 0.5609
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 284	| desk    	| 0.1695	| 0.0243	| 0.5525
 display    	| OOD	| 172	| display    	| 0.1294	| 0.0397	| 0.5397
 desk    	| OOD	| 101	| bed    	| 0.1183	| 0.0255	| 0.4930
 bed    	| OOD	| 96	| bed    	| 0.1646	| 0.0275	| 0.4226
 bed    	| OOD	| 39	| desk    	| 0.1407	| 0.0420	| 0.3871
Fail tar: 1/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 1	| desk    	| 0.5609	| 0.5609	| 0.5609
OOD J Test - Acc: 0.6858, Th: 0.1194
Fail src: 361/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 95	| desk    	| 0.0783	| 0.0243	| 0.1190
 display    	| OOD	| 84	| display    	| 0.0779	| 0.0397	| 0.1181
 desk    	| OOD	| 62	| bed    	| 0.0712	| 0.0255	| 0.1151
 bed    	| OOD	| 27	| bed    	| 0.0797	| 0.0275	| 0.1154
 toilet    	| OOD	| 27	| desk    	| 0.0775	| 0.0504	| 0.1135
Fail tar: 547/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 129	| desk    	| 0.2136	| 0.1220	| 0.5609
 cabinet    	| ID	| 57	| display    	| 0.1667	| 0.1206	| 0.3079
 sofa    	| ID	| 48	| bed    	| 0.1787	| 0.1203	| 0.3217
 shelf    	| ID	| 48	| desk    	| 0.1677	| 0.1242	| 0.3119
 door    	| ID	| 36	| display    	| 0.1382	| 0.1198	| 0.1823
SRC->TAR1:      AUROC: 0.6265, FPR95: 0.9546, AUPR_IN: 0.5173, AUPR_OUT: 0.6764, F1_TH: 0.5609, F1_TH_ACC: 0.6138, J_TH: 0.1194, J_TH_ACC: 0.6388
SRC->TAR2:      AUROC: 0.7241, FPR95: 0.8418, AUPR_IN: 0.7156, AUPR_OUT: 0.6967, F1_TH: 0.0608, F1_TH_ACC: 0.6110, J_TH: 0.0969, J_TH_ACC: 0.6789
SRC->TAR1+TAR2: AUROC: 0.6659, FPR95: 0.9091, AUPR_IN: 0.4357, AUPR_OUT: 0.8099, F1_TH: 0.5609, F1_TH_ACC: 0.7270, J_TH: 0.1194, J_TH_ACC: 0.6858
to spreadsheet: 0.6265182923129815,0.9545816733067729,0.5172718337263644,0.6763689958065608,0.7241353478086289,0.8417945690672963,0.71556058904359,0.6967432033159713,0.6658530430288776,0.9091341579448144,0.4356544295754923,0.8099056231780675

Euclidean distances with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713, Clf Bal Acc: 0.2500
Src Test - Fail: 653/788
	A desk is predicted as bed - 390 times
	A display is predicted as bed - 181 times
	A toilet is predicted as bed - 82 times
Test Tar1
OOD F1 Test - Acc: 0.3857, Th: 0.0109
OOD J Test - Acc: 0.5957, Th: 0.0195
Test Tar2
OOD F1 Test - Acc: 0.4820, Th: 0.0109
OOD J Test - Acc: 0.5676, Th: 0.0189
Test Tar1+Tar2
OOD F1 Test - Acc: 0.2727, Th: 0.0109
Fail src: 0/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
Fail tar: 2102/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 395	| bed    	| 0.0151	| 0.0109	| 0.0652
 cabinet    	| ID	| 347	| bed    	| 0.0195	| 0.0112	| 0.1034
 shelf    	| ID	| 267	| bed    	| 0.0158	| 0.0116	| 0.0651
 sofa    	| ID	| 254	| bed    	| 0.0144	| 0.0112	| 0.0351
 door    	| ID	| 221	| bed    	| 0.0264	| 0.0142	| 0.0963
OOD J Test - Acc: 0.6536, Th: 0.0189
Fail src: 542/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 316	| bed    	| 0.0133	| 0.0109	| 0.0187
 bed    	| OOD	| 82	| bed    	| 0.0137	| 0.0109	| 0.0184
 toilet    	| OOD	| 73	| bed    	| 0.0146	| 0.0118	| 0.0185
 display    	| OOD	| 71	| bed    	| 0.0159	| 0.0129	| 0.0188
Fail tar: 459/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 164	| bed    	| 0.0297	| 0.0190	| 0.0963
 cabinet    	| ID	| 90	| bed    	| 0.0333	| 0.0192	| 0.1034
 sink    	| ID	| 42	| bed    	| 0.0286	| 0.0190	| 0.0615
 chair    	| ID	| 38	| bed    	| 0.0252	| 0.0189	| 0.0652
 shelf    	| ID	| 34	| bed    	| 0.0263	| 0.0190	| 0.0651
SRC->TAR1:      AUROC: 0.5041, FPR95: 0.9865, AUPR_IN: 0.4245, AUPR_OUT: 0.5840, F1_TH: 0.0109, F1_TH_ACC: 0.3857, J_TH: 0.0195, J_TH_ACC: 0.5957
SRC->TAR2:      AUROC: 0.4939, FPR95: 0.9870, AUPR_IN: 0.5220, AUPR_OUT: 0.4752, F1_TH: 0.0109, F1_TH_ACC: 0.4820, J_TH: 0.0189, J_TH_ACC: 0.5676
SRC->TAR1+TAR2: AUROC: 0.5000, FPR95: 0.9867, AUPR_IN: 0.3084, AUPR_OUT: 0.6932, F1_TH: 0.0109, F1_TH_ACC: 0.2727, J_TH: 0.0189, J_TH_ACC: 0.6536
to spreadsheet: 0.5041205735433899,0.9864541832669322,0.4244785733981171,0.5840340457174145,0.4938990405072546,0.987012987012987,0.5219710979988266,0.47519432960385866,0.500001811182968,0.9866793529971456,0.30844712553426556,0.6932160342808745

Cosine similarities on the hypersphere:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7132, Clf Bal Acc: 0.6621
Src Test - Fail: 226/788
	A desk is predicted as bed - 114 times
	A bed is predicted as desk - 38 times
	A toilet is predicted as desk - 33 times
	A toilet is predicted as bed - 17 times
	A toilet is predicted as display - 8 times
Test Tar1
OOD F1 Test - Acc: 0.4674, Th: 0.9522
OOD J Test - Acc: 0.6490, Th: 0.9969
Test Tar2
OOD F1 Test - Acc: 0.6520, Th: 0.9637
OOD J Test - Acc: 0.6844, Th: 0.9881
Test Tar1+Tar2
OOD F1 Test - Acc: 0.5785, Th: 0.9881
Fail src: 221/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 50	| desk    	| 0.9742	| 0.9367	| 0.9864
 desk    	| OOD	| 41	| bed    	| 0.9652	| 0.8991	| 0.9875
 display    	| OOD	| 40	| display    	| 0.9596	| 0.8663	| 0.9874
 toilet    	| OOD	| 21	| desk    	| 0.9630	| 0.8851	| 0.9861
 toilet    	| OOD	| 18	| toilet    	| 0.9488	| 0.7929	| 0.9875
Fail tar: 997/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 182	| display    	| 0.9943	| 0.9886	| 0.9996
 chair    	| ID	| 142	| desk    	| 0.9973	| 0.9883	| 0.9999
 sofa    	| ID	| 116	| bed    	| 0.9959	| 0.9881	| 1.0000
 cabinet    	| ID	| 98	| display    	| 0.9960	| 0.9887	| 0.9997
 shelf    	| ID	| 57	| desk    	| 0.9950	| 0.9883	| 0.9999
OOD J Test - Acc: 0.7000, Th: 0.9969
Fail src: 401/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 100	| desk    	| 0.9837	| 0.9367	| 0.9967
 display    	| OOD	| 90	| display    	| 0.9781	| 0.8663	| 0.9967
 desk    	| OOD	| 76	| bed    	| 0.9781	| 0.8991	| 0.9968
 bed    	| OOD	| 30	| bed    	| 0.9877	| 0.9642	| 0.9968
 toilet    	| OOD	| 25	| desk    	| 0.9676	| 0.8851	| 0.9964
Fail tar: 466/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 98	| desk    	| 0.9991	| 0.9970	| 0.9999
 sofa    	| ID	| 58	| bed    	| 0.9987	| 0.9970	| 1.0000
 cabinet    	| ID	| 47	| display    	| 0.9987	| 0.9970	| 0.9997
 door    	| ID	| 34	| display    	| 0.9981	| 0.9970	| 0.9996
 sink    	| ID	| 31	| bed    	| 0.9988	| 0.9971	| 0.9999
SRC->TAR1:      AUROC: 0.6524, FPR95: 0.8598, AUPR_IN: 0.5738, AUPR_OUT: 0.7305, F1_TH: 0.9522, F1_TH_ACC: 0.4674, J_TH: 0.9969, J_TH_ACC: 0.6490
SRC->TAR2:      AUROC: 0.7523, FPR95: 0.7178, AUPR_IN: 0.7333, AUPR_OUT: 0.7617, F1_TH: 0.9637, F1_TH_ACC: 0.6520, J_TH: 0.9881, J_TH_ACC: 0.6844
SRC->TAR1+TAR2: AUROC: 0.6927, FPR95: 0.8026, AUPR_IN: 0.4889, AUPR_OUT: 0.8474, F1_TH: 0.9881, F1_TH_ACC: 0.5785, J_TH: 0.9969, J_TH_ACC: 0.7000
to spreadsheet: 0.6524187513903775,0.8597609561752988,0.5738278848730408,0.7304735216966207,0.7523388010236187,0.717827626918536,0.7333167472786029,0.7616831739696309,0.6926814926079585,0.8025689819219791,0.4889092968610542,0.8474117404920768

Cosine similarities with prototypes:
AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.1713, Clf Bal Acc: 0.2500
Src Test - Fail: 653/788
	A desk is predicted as bed - 390 times
	A display is predicted as bed - 181 times
	A toilet is predicted as bed - 82 times
Test Tar1
OOD F1 Test - Acc: 0.4019, Th: 0.7812
OOD J Test - Acc: 0.6344, Th: 0.9864
Test Tar2
OOD F1 Test - Acc: 0.5058, Th: 0.7812
OOD J Test - Acc: 0.6287, Th: 0.9504
Test Tar1+Tar2
OOD F1 Test - Acc: 0.5208, Th: 0.9269
Fail src: 232/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 118	| bed    	| 0.8658	| 0.7596	| 0.9264
 toilet    	| OOD	| 42	| bed    	| 0.8576	| 0.7060	| 0.9249
 display    	| OOD	| 39	| bed    	| 0.8737	| 0.7454	| 0.9175
 bed    	| OOD	| 33	| bed    	| 0.8617	| 0.7813	| 0.9125
Fail tar: 1153/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 245	| bed    	| 0.9720	| 0.9278	| 0.9993
 cabinet    	| ID	| 197	| bed    	| 0.9712	| 0.9285	| 0.9981
 door    	| ID	| 152	| bed    	| 0.9669	| 0.9273	| 0.9969
 sofa    	| ID	| 151	| bed    	| 0.9734	| 0.9277	| 0.9991
 shelf    	| ID	| 125	| bed    	| 0.9673	| 0.9278	| 0.9991
OOD J Test - Acc: 0.6405, Th: 0.9704
Fail src: 409/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 202	| bed    	| 0.9004	| 0.7596	| 0.9697
 display    	| OOD	| 94	| bed    	| 0.9201	| 0.7454	| 0.9695
 toilet    	| OOD	| 63	| bed    	| 0.8884	| 0.7060	| 0.9680
 bed    	| OOD	| 50	| bed    	| 0.8911	| 0.7813	| 0.9688
Fail tar: 630/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 141	| bed    	| 0.9871	| 0.9707	| 0.9993
 cabinet    	| ID	| 113	| bed    	| 0.9863	| 0.9705	| 0.9981
 sofa    	| ID	| 91	| bed    	| 0.9868	| 0.9708	| 0.9991
 door    	| ID	| 70	| bed    	| 0.9833	| 0.9705	| 0.9969
 shelf    	| ID	| 62	| bed    	| 0.9862	| 0.9705	| 0.9991
SRC->TAR1:      AUROC: 0.6006, FPR95: 0.9235, AUPR_IN: 0.5175, AUPR_OUT: 0.6843, F1_TH: 0.7812, F1_TH_ACC: 0.4019, J_TH: 0.9864, J_TH_ACC: 0.6344
SRC->TAR2:      AUROC: 0.6585, FPR95: 0.8949, AUPR_IN: 0.6538, AUPR_OUT: 0.6488, F1_TH: 0.7812, F1_TH_ACC: 0.5058, J_TH: 0.9504, J_TH_ACC: 0.6287
SRC->TAR1+TAR2: AUROC: 0.6240, FPR95: 0.9120, AUPR_IN: 0.4173, AUPR_OUT: 0.7985, F1_TH: 0.9269, F1_TH_ACC: 0.5208, J_TH: 0.9704, J_TH_ACC: 0.6405
to spreadsheet: 0.6006142940926649,0.9235059760956176,0.5175015484138241,0.6843333404817484,0.6585485349906208,0.8949232585596222,0.6537616399742876,0.6488048555654308,0.6239588716571599,0.911988582302569,0.4172638115372609,0.7984881855100209
################################################################################

################################################################################
Computing OOD metrics with ODIN normality score...

  warnings.warn(_create_warning_msg(



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6133, Th: 0.2502
OOD J Test - Acc: 0.4895, Th: 0.2501
Test Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.5150, Th: 0.2502
OOD J Test - Acc: 0.6526, Th: 0.2501
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7249, Th: 0.2502
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 0.2501	| 0.2500	| 0.2502
 display    	| OOD	| 171	| display    	| 0.2501	| 0.2500	| 0.2502
 desk    	| OOD	| 101	| bed    	| 0.2501	| 0.2501	| 0.2502
 bed    	| OOD	| 91	| bed    	| 0.2501	| 0.2501	| 0.2502
 bed    	| OOD	| 44	| desk    	| 0.2501	| 0.2501	| 0.2501
Fail tar: 7/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 box    	| ID	| 2	| display    	| 0.2502	| 0.2502	| 0.2502
 cabinet    	| ID	| 2	| display    	| 0.2502	| 0.2502	| 0.2502
 bag    	| ID	| 1	| display    	| 0.2502	| 0.2502	| 0.2502
 chair    	| ID	| 1	| display    	| 0.2502	| 0.2502	| 0.2502
 shelf    	| ID	| 1	| display    	| 0.2502	| 0.2502	| 0.2502
OOD J Test - Acc: 0.5076, Th: 0.2501
Fail src: 188/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 50	| desk    	| 0.2501	| 0.2500	| 0.2501
 display    	| OOD	| 35	| display    	| 0.2501	| 0.2500	| 0.2501
 desk    	| OOD	| 29	| bed    	| 0.2501	| 0.2501	| 0.2501
 toilet    	| OOD	| 22	| desk    	| 0.2501	| 0.2500	| 0.2501
 bed    	| OOD	| 14	| desk    	| 0.2501	| 0.2501	| 0.2501
Fail tar: 1235/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 203	| display    	| 0.2501	| 0.2501	| 0.2502
 chair    	| ID	| 172	| desk    	| 0.2501	| 0.2501	| 0.2502
 sofa    	| ID	| 139	| bed    	| 0.2501	| 0.2501	| 0.2502
 cabinet    	| ID	| 119	| display    	| 0.2501	| 0.2501	| 0.2502
 chair    	| ID	| 65	| bed    	| 0.2501	| 0.2501	| 0.2502
SRC->TAR1:      AUROC: 0.5154, FPR95: 0.8869, AUPR_IN: 0.4017, AUPR_OUT: 0.6515, F1_TH: 0.2502, F1_TH_ACC: 0.6133, J_TH: 0.2501, J_TH_ACC: 0.4895
SRC->TAR2:      AUROC: 0.6676, FPR95: 0.7651, AUPR_IN: 0.5815, AUPR_OUT: 0.7013, F1_TH: 0.2502, F1_TH_ACC: 0.5150, J_TH: 0.2501, J_TH_ACC: 0.6526
SRC->TAR1+TAR2: AUROC: 0.5767, FPR95: 0.8378, AUPR_IN: 0.3096, AUPR_OUT: 0.7973, F1_TH: 0.2502, F1_TH_ACC: 0.7249, J_TH: 0.2501, J_TH_ACC: 0.5076
to spreadsheet: 0.5153593746840052,0.8868525896414342,0.4017101621675273,0.6515325014653701,0.6675666281111597,0.7650531286894924,0.5815270010523367,0.7013153030257373,0.5766912222828633,0.8377735490009515,0.3096099995954194,0.7972564575093437
################################################################################

################################################################################
Computing OOD metrics with Energy normality score...

  warnings.warn(_create_warning_msg(



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 2.0320
OOD J Test - Acc: 0.5286, Th: 1.8418
Test Tar2
OOD F1 Test - Acc: 0.5083, Th: 1.6058
OOD J Test - Acc: 0.5272, Th: 1.8298
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7270, Th: 2.0320
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 1.9016	| 1.8318	| 2.0008
 display    	| OOD	| 171	| display    	| 1.8456	| 1.5967	| 1.9543
 desk    	| OOD	| 101	| bed    	| 1.8569	| 1.5532	| 1.9964
 bed    	| OOD	| 91	| bed    	| 1.7638	| 1.5307	| 1.9840
 bed    	| OOD	| 44	| desk    	| 1.9258	| 1.8472	| 1.9985
Fail tar: 1/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 1	| toilet    	| 2.0320	| 2.0320	| 2.0320
OOD J Test - Acc: 0.4682, Th: 1.8418
Fail src: 201/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 display    	| OOD	| 77	| display    	| 1.8111	| 1.5967	| 1.8410
 bed    	| OOD	| 66	| bed    	| 1.7012	| 1.5307	| 1.8407
 desk    	| OOD	| 34	| bed    	| 1.7279	| 1.5532	| 1.8323
 toilet    	| OOD	| 8	| bed    	| 1.6694	| 1.4203	| 1.8052
 desk    	| OOD	| 7	| desk    	| 1.8358	| 1.8318	| 1.8397
Fail tar: 1336/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 196	| desk    	| 1.9017	| 1.8425	| 2.0061
 shelf    	| ID	| 154	| desk    	| 1.9089	| 1.8438	| 2.0020
 cabinet    	| ID	| 136	| desk    	| 1.9039	| 1.8522	| 2.0018
 cabinet    	| ID	| 123	| display    	| 1.8892	| 1.8424	| 2.0214
 door    	| ID	| 94	| display    	| 1.8875	| 1.8418	| 2.0092
SRC->TAR1:      AUROC: 0.5586, FPR95: 0.8916, AUPR_IN: 0.4188, AUPR_OUT: 0.6841, F1_TH: 2.0320, F1_TH_ACC: 0.6138, J_TH: 1.8418, J_TH_ACC: 0.5286
SRC->TAR2:      AUROC: 0.5206, FPR95: 0.9115, AUPR_IN: 0.4981, AUPR_OUT: 0.5639, F1_TH: 1.6058, F1_TH_ACC: 0.5083, J_TH: 1.8298, J_TH_ACC: 0.5272
SRC->TAR1+TAR2: AUROC: 0.5433, FPR95: 0.8996, AUPR_IN: 0.2946, AUPR_OUT: 0.7728, F1_TH: 2.0320, F1_TH_ACC: 0.7270, J_TH: 1.8418, J_TH_ACC: 0.4682
to spreadsheet: 0.5585814103990131,0.8916334661354581,0.41875043294530734,0.6840807001406467,0.5205622711391055,0.911452184179457,0.49806813795287497,0.5639482318801219,0.5432616145126469,0.8996194100856327,0.29459010209816683,0.772756567295734
################################################################################

################################################################################
Computing OOD metrics with GradNorm normality score...

  warnings.warn(_create_warning_msg(



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6114, Th: 5.8628
OOD J Test - Acc: 0.4435, Th: 2.3472
Test Tar2
OOD F1 Test - Acc: 0.5872, Th: 2.3295
OOD J Test - Acc: 0.6190, Th: 2.5794
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7253, Th: 5.8628
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 2.8202	| 1.7385	| 4.0498
 display    	| OOD	| 171	| display    	| 3.1430	| 1.9581	| 4.5555
 desk    	| OOD	| 101	| bed    	| 3.6379	| 2.2813	| 5.3700
 bed    	| OOD	| 91	| bed    	| 3.8572	| 3.2677	| 5.6825
 bed    	| OOD	| 44	| desk    	| 2.8704	| 2.0205	| 3.7195
Fail tar: 6/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 3	| bed    	| 6.2101	| 6.0396	| 6.3246
 sofa    	| ID	| 2	| bed    	| 5.9423	| 5.8628	| 6.0217
 sofa    	| ID	| 1	| desk    	| 5.9908	| 5.9908	| 5.9908
OOD J Test - Acc: 0.4062, Th: 2.3970
Fail src: 75/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 24	| desk    	| 2.1566	| 1.7385	| 2.3942
 display    	| OOD	| 20	| display    	| 2.2988	| 1.9581	| 2.3881
 toilet    	| OOD	| 13	| desk    	| 2.0740	| 1.3846	| 2.3836
 toilet    	| OOD	| 7	| toilet    	| 2.2285	| 1.9682	| 2.3574
 desk    	| OOD	| 2	| bed    	| 2.3143	| 2.2813	| 2.3472
Fail tar: 1641/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 door    	| ID	| 212	| display    	| 3.4405	| 2.4071	| 4.0761
 chair    	| ID	| 192	| desk    	| 3.0225	| 2.4175	| 5.1927
 sofa    	| ID	| 157	| bed    	| 3.8284	| 2.5220	| 6.0217
 cabinet    	| ID	| 148	| display    	| 3.1620	| 2.3983	| 3.9715
 shelf    	| ID	| 101	| desk    	| 2.8941	| 2.4109	| 3.9929
SRC->TAR1:      AUROC: 0.4761, FPR95: 0.8972, AUPR_IN: 0.3593, AUPR_OUT: 0.6316, F1_TH: 5.8628, F1_TH_ACC: 0.6114, J_TH: 2.3472, J_TH_ACC: 0.4435
SRC->TAR2:      AUROC: 0.6380, FPR95: 0.7981, AUPR_IN: 0.5793, AUPR_OUT: 0.6819, F1_TH: 2.3295, F1_TH_ACC: 0.5872, J_TH: 2.5794, J_TH_ACC: 0.6190
SRC->TAR1+TAR2: AUROC: 0.5413, FPR95: 0.8573, AUPR_IN: 0.2838, AUPR_OUT: 0.7819, F1_TH: 5.8628, F1_TH_ACC: 0.7253, J_TH: 2.3970, J_TH_ACC: 0.4062
to spreadsheet: 0.4760723603049729,0.8972111553784861,0.35929522064553476,0.6315860804768415,0.6379533018896194,0.7981109799291618,0.5793048785293937,0.6818510297873472,0.5413022164049708,0.857278782112274,0.2838341235434718,0.7819248403654846
################################################################################

################################################################################
Building React validation loader...
ModelNet40_OOD - Reading data from h5py file: /content/3D_OS_release_data/modelnet40_normal_resampled/ood_sets_cache/SR2_test.h5
ModelNet40_OOD - split: test, categories: {'bed': 0, 'toilet': 1, 'desk': 2, 'monitor': 3, 'table': 2}
React Val - SR2 data len: 486
/usr/local/lib/python3.10/dist-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Estimating react threshold...
t = 8.0330
Computing OOD metrics with React (+Energy) normality score, ID-dependent threshold (=8.0330)...
React - using SR2 test to compute threshold



AUROC - Src label: 1, Tar label: 0
Src Test - Clf Acc: 0.7208, Clf Bal Acc: 0.6514
Src Test - Fail: 220/788
	A desk is predicted as bed - 101 times
	A bed is predicted as desk - 44 times
	A toilet is predicted as desk - 39 times
	A toilet is predicted as bed - 14 times
	A toilet is predicted as display - 8 times
Test Tar1
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.6138, Th: 2.0320
OOD J Test - Acc: 0.5291, Th: 1.8446
Test Tar2
OOD F1 Test - Acc: 0.5083, Th: 1.6059
OOD J Test - Acc: 0.5260, Th: 1.8301
Test Tar1+Tar2
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
/content/SemNov_AML_DAAI_23-24/utils/ood_metrics.py:110: RuntimeWarning: invalid value encountered in divide
  f1 = 2 * (precision * recall) / (precision + recall)
OOD F1 Test - Acc: 0.7270, Th: 2.0320
Fail src: 788/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 desk    	| OOD	| 285	| desk    	| 1.9004	| 1.8268	| 2.0008
 display    	| OOD	| 171	| display    	| 1.8455	| 1.5967	| 1.9543
 desk    	| OOD	| 101	| bed    	| 1.8568	| 1.5532	| 1.9964
 bed    	| OOD	| 91	| bed    	| 1.7640	| 1.5322	| 1.9840
 bed    	| OOD	| 44	| desk    	| 1.9248	| 1.8404	| 1.9985
Fail tar: 1/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 shelf    	| ID	| 1	| toilet    	| 2.0320	| 2.0320	| 2.0320
OOD J Test - Acc: 0.4633, Th: 1.8397
Fail src: 203/788
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 display    	| OOD	| 75	| display    	| 1.8102	| 1.5967	| 1.8383
 bed    	| OOD	| 65	| bed    	| 1.6995	| 1.5322	| 1.8280
 desk    	| OOD	| 35	| bed    	| 1.7310	| 1.5532	| 1.8377
 desk    	| OOD	| 11	| desk    	| 1.8337	| 1.8268	| 1.8391
 toilet    	| OOD	| 8	| bed    	| 1.6694	| 1.4203	| 1.8052
Fail tar: 1348/2102
 True class	| Pred	| Times	| Closest class	| Mean score	| Min score	| Max score
 chair    	| ID	| 200	| desk    	| 1.9002	| 1.8397	| 2.0062
 shelf    	| ID	| 153	| desk    	| 1.9093	| 1.8484	| 2.0020
 cabinet    	| ID	| 136	| desk    	| 1.9038	| 1.8487	| 2.0018
 cabinet    	| ID	| 124	| display    	| 1.8887	| 1.8409	| 2.0214
 door    	| ID	| 98	| display    	| 1.8854	| 1.8401	| 2.0092
SRC->TAR1:      AUROC: 0.5570, FPR95: 0.8916, AUPR_IN: 0.4174, AUPR_OUT: 0.6833, F1_TH: 2.0320, F1_TH_ACC: 0.6138, J_TH: 1.8446, J_TH_ACC: 0.5291
SRC->TAR2:      AUROC: 0.5191, FPR95: 0.9115, AUPR_IN: 0.4968, AUPR_OUT: 0.5634, F1_TH: 1.6059, F1_TH_ACC: 0.5083, J_TH: 1.8301, J_TH_ACC: 0.5260
SRC->TAR1+TAR2: AUROC: 0.5417, FPR95: 0.8996, AUPR_IN: 0.2935, AUPR_OUT: 0.7722, F1_TH: 2.0320, F1_TH_ACC: 0.7270, J_TH: 1.8397, J_TH_ACC: 0.4633
to spreadsheet: 0.5569761562885513,0.8916334661354581,0.417397778456636,0.6832792817411195,0.5191494015905646,0.911452184179457,0.49681897236201017,0.5633709487443324,0.5417338816790391,0.8996194100856327,0.2934692035362117,0.7721598982092561
################################################################################
